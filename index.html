<!doctype html><html lang=en-us dir=ltr><head><meta name=generator content="Hugo 0.136.5"><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Magic Modules
  #

Magic Modules is a code generator and CI system that&rsquo;s used to develop the Terraform providers
for Google Cloud, google (or TPG) and
google-beta (or TPGB).
Magic Modules allows contributors to make changes against a single codebase and develop both
provider versions simultaneously. After sending a pull request against this repository, the
modular-magician robot user will manage (most of) the heavy lifting from generating a
complete output, running presubmit tests, and updating the providers following your
change."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/"><meta property="og:site_name" content="Magic Modules"><meta property="og:title" content="Overview"><meta property="og:description" content="Magic Modules # Magic Modules is a code generator and CI system thatâ€™s used to develop the Terraform providers for Google Cloud, google (or TPG) and google-beta (or TPGB).
Magic Modules allows contributors to make changes against a single codebase and develop both provider versions simultaneously. After sending a pull request against this repository, the modular-magician robot user will manage (most of) the heavy lifting from generating a complete output, running presubmit tests, and updating the providers following your change."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Overview | Magic Modules</title>
<link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png><link rel=canonical href=https://googlecloudplatform.github.io/magic-modules/><link rel=stylesheet href=/magic-modules/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/magic-modules/fuse.min.js></script><script defer src=/magic-modules/en.search.min.915ba9df3e382d416ae5e08ed09b538253c2552b7cb3e8ab3a905f88656f70a6.js integrity="sha256-kVup3z44LUFq5eCO0JtTglPCVSt8s+irOpBfiGVvcKY=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://googlecloudplatform.github.io/magic-modules/index.xml title="Magic Modules"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/magic-modules/ class=active>Overview</a></li></ul><ul><li><a href=/magic-modules/contribution-process/>Contribution process</a></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/set-up-dev-environment/>Set up your development environment</a></li><li><a href=/magic-modules/develop/add-resource/>Add a resource</a></li><li><a href=/magic-modules/develop/add-fields/>Add a field to an existing resource</a></li><li><a href=/magic-modules/develop/add-iam-support/>Add IAM support</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/update-dependencies/>Update dependencies</a></li><li><a href=/magic-modules/develop/diffs/>Fix diffs</a></li><li><a href=/magic-modules/develop/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/develop/client-side-fields/>Client-side fields</a></li></ul></li><li><span>Test</span><ul><li><a href=/magic-modules/test/test/>Add resource tests</a></li><li><a href=/magic-modules/test/run-tests/>Run tests</a></li></ul></li><li><span>Document</span><ul><li><a href=/magic-modules/document/add-documentation/>Add documentation</a></li><li><a href=/magic-modules/document/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><span>Breaking changes</span><ul><li><a href=/magic-modules/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><span>Code review</span><ul><li><a href=/magic-modules/code-review/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/code-review/release-notes/>Write release notes</a></li><li><a href=/magic-modules/code-review/review-pr/>Review a pull request</a></li></ul></li><li><span>Best practices</span><ul><li><a href=/magic-modules/best-practices/immutable-fields/>Immutable fields</a></li><li><a href=/magic-modules/best-practices/deletion-behaviors/>Deletion behaviors</a></li><li><a href=/magic-modules/best-practices/labels-and-annotations/>Labels and annotations</a></li><li><a href=/magic-modules/best-practices/common-resource-patterns/>Common resource patterns</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/resource/>MMv1 resource reference</a></li><li><a href=/magic-modules/reference/field/>MMv1 field reference</a></li><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=/magic-modules/reference/metadata/>MMv1 metadata reference</a></li><li><a href=/magic-modules/reference/ruby-go-changes/>Ruby to Go Migration</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Overview</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#how-magic-modules-works>How Magic Modules works</a><ul><li><a href=#resource-types>Resource types</a></li></ul></li><li><a href=#other-resources>Other Resources</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=magic-modules>Magic Modules
<a class=anchor href=#magic-modules>#</a></h1><p>Magic Modules is a code generator and CI system that&rsquo;s used to develop the Terraform providers
for Google Cloud, <a href=https://github.com/hashicorp/terraform-provider-google><code>google</code></a> (or TPG) and
<a href=https://github.com/hashicorp/terraform-provider-google-beta><code>google-beta</code></a> (or TPGB).</p><p>Magic Modules allows contributors to make changes against a single codebase and develop both
provider versions simultaneously. After sending a pull request against this repository, the
<code>modular-magician</code> robot user will manage (most of) the heavy lifting from generating a
complete output, running presubmit tests, and updating the providers following your
change.</p><h2 id=how-magic-modules-works>How Magic Modules works
<a class=anchor href=#how-magic-modules-works>#</a></h2><p>Magic Modules can be thought of as a source of truth for how to map a Google Cloud API resource
representation to a Terraform resource (or datasource) representation. Magic Modules uses that mapping
(and additional handwritten code where necessary) to generate &ldquo;downstream&rdquo; repositories - in particular,
the Terraform providers for Google Cloud: <a href=https://github.com/hashicorp/terraform-provider-google><code>google</code></a>
(or TPG) and <a href=https://github.com/hashicorp/terraform-provider-google-beta><code>google-beta</code></a> (or TPGB).</p><p>Generation of the downstream repositories happens for every new commit in a PR (to a temporary branch owned by
the <a href=https://github.com/modular-magician/><code>modular-magician</code></a> robot user) and on every merge into the main branch
(to the main branch of downstreams). Generation for PR commits allows contributors to manually examine the changes,
as well as allowing automatic running of unit tests, acceptance tests, and automated checks such as breaking change
detection.</p><h3 id=resource-types>Resource types
<a class=anchor href=#resource-types>#</a></h3><p>There are three types of resources supported by Magic Modules:</p><ul><li>MMv1</li><li>Handwritten</li><li>DCL/tpgtools</li></ul><p>The following sections describe these tools in detail.</p><h4 id=mmv1>MMv1
<a class=anchor href=#mmv1>#</a></h4><p>MMv1 consists of a set of &ldquo;products&rdquo;; each product contains one or more &ldquo;resources&rdquo;.</p><p>Each product has a folder in
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/products><code>magic-modules/mmv1/products</code></a>.
The name of the folder is the &ldquo;product name&rdquo;, which usually corresponds to the API subdomain covered by the
product (such as <code>compute.googleapis.com</code>). Each product folder contains a product configuration file
(<code>product.yaml</code>) and one or more resource configuration files (<code>ResourceName.yaml</code>). The actual name of a
<code>ResourceName.yaml</code> file usually matches the name of a GCP API resource in the product&rsquo;s subdomain.</p><p>MMv1 resource configurations may reference handwritten code stored in
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/templates/terraform><code>magic-modules/mmv1/templates/terraform</code></a>,
which will be injected into the generated resource file. Many MMv1 resources also have one or more handwritten tests,
which are stored in the appropriate service folder inside
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/services><code>magic-modules/mmv1/third_party/terraform/services</code></a>.</p><p>In the providers, MMv1-based resources are stored in <code>PROVIDER/services/PRODUCT/resource_PRODUCT_RESOURCE.go</code>, where <code>PROVIDER</code>
is <code>google</code> or <code>google-beta</code>, <code>PRODUCT</code> is the product name, and RESOURCE is the GCP API resource&rsquo;s name converted to
<a href=https://en.wikipedia.org/wiki/Snake_case>snake case â†—</a>.</p><p>MMv1-based files start with the following header:</p><pre tabindex=0><code>*** Â  Â  AUTO GENERATED CODE Â  Â *** Â  Â Type: MMv1 Â  Â  ***
</code></pre><h4 id=handwritten>Handwritten
<a class=anchor href=#handwritten>#</a></h4><p>Handwritten resources and datasources are technically part of MMv1; however, they are not generated from YAML configurations.
Instead, they are written as Go code with minimal go template &ldquo;version guards&rdquo; to exclude beta-only features from the <code>google</code>
provider.</p><p>Handwritten resources and datasources can be grouped by &ldquo;service&rdquo;, which generally corresponds to the API subdomain the resource
or datasource interacts with.</p><p>In addition to the core implementation, handwritten resources and datasources will also have documentation, tests, and sweepers
(which clean up stray resources left behind by tests). Each type of code is stored in the following locations:</p><ul><li>Resource & datasource implementation: In the appropriate service folder inside
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/services><code>magic-modules/mmv1/third_party/terraform/services</code></a></li><li>Resource documentation:
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/website/docs/r><code>magic-modules/mmv1/third_party/terraform/website/docs/r</code></a></li><li>Datasource documentation:
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/website/docs/d><code>magic-modules/mmv1/third_party/terraform/website/docs/d</code></a></li><li>Tests: In the appropriate service folder inside
<a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/services><code>magic-modules/mmv1/third_party/terraform/services</code></a></li><li>Sweepers: <a href=https://github.com/GoogleCloudPlatform/magic-modules/tree/main/mmv1/third_party/terraform/utils><code>magic-modules/mmv1/third_party/terraform/utils</code></a></li></ul><p>In the providers, handwritten resources and datasources are stored in <code>PROVIDER/services/SERVICE/FILENAME.go</code>, where <code>PROVIDER</code>
is <code>google</code> or <code>google-beta</code>, <code>SERVICE</code> is the service name, and <code>FILENAME</code> is the name of the handwritten file in magic-modules.
Handwritten files do not have an <code>AUTO GENERATED CODE</code> header.</p><h4 id=dcl-aka-tpgtools-maintenance-mode>DCL aka tpgtools (maintenance mode)
<a class=anchor href=#dcl-aka-tpgtools-maintenance-mode>#</a></h4><p>DCL / tpgtools is similar to MMv1; however, it is in maintenance mode, which means that new resources using the DCL are not being added.</p><p>DCL-based files start with the following header:</p><pre tabindex=0><code>*** Â  Â  AUTO GENERATED CODE Â  Â *** Â  Â Type: DCL Â  Â  ***
</code></pre><h2 id=other-resources>Other Resources
<a class=anchor href=#other-resources>#</a></h2><ul><li><a href=https://www.terraform.io/plugin>Extending Terraform</a><ul><li><a href=https://www.terraform.io/plugin/how-terraform-works>How Terraform Works</a></li><li><a href="https://learn.hashicorp.com/collections/terraform/providers?utm_source=WEBSITE&amp;utm_medium=WEB_IO&amp;utm_offer=ARTICLE_PAGE&amp;utm_content=DOCS">Writing Custom Providers / Calling APIs with Terraform Providers</a></li></ul></li><li><a href=https://www.terraform.io/docs/glossary>Terraform Glossary</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/727c6c279f274b2668f6954604d36c6e7a2a6102 title='Last modified by nityaravi | November 20, 2024' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 20, 2024</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/_index.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/_index.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#how-magic-modules-works>How Magic Modules works</a><ul><li><a href=#resource-types>Resource types</a></li></ul></li><li><a href=#other-resources>Other Resources</a></li></ul></nav></div></aside></main></body></html>