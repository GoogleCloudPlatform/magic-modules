<% autogen_exception -%>
// Contains common diff suppress functions.

package google

func TestOptionalPrefixSuppress(t *testing.T) {
	cases := map[string]struct {
		Old, New           string
		Prefix             string
		ExpectDiffSuppress bool
	}{
		"with same prefix": {
			Old:                "my-folder",
			New:                "folders/my-folder",
			Prefix:             "folders/",
			ExpectDiffSuppress: true,
		},
		"with different prefix": {
			Old:                "folders/my-folder",
			New:                "organizations/my-folder",
			Prefix:             "folders/",
			ExpectDiffSuppress: false,
		},
		"same without prefix": {
			Old:                "my-folder",
			New:                "my-folder",
			Prefix:             "folders/",
			ExpectDiffSuppress: false,
		},
		"different without prefix": {
			Old:                "my-folder",
			New:                "my-new-folder",
			Prefix:             "folders/",
			ExpectDiffSuppress: false,
		},
	}

	for tn, tc := range cases {
		if optionalPrefixSuppress(tc.Prefix)("folder", tc.Old, tc.New, nil) != tc.ExpectDiffSuppress {
			t.Fatalf("bad: %s, '%s' => '%s' expect %t", tn, tc.Old, tc.New, tc.ExpectDiffSuppress)
		}
	}
}