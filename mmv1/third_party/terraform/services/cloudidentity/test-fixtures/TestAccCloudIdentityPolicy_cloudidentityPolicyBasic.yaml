---
version: 1
interactions:
- request:
    body: |
      {"customer":"customers/C02v7e0bo","policyQuery":{"orgUnit":"orgUnits/03ph8a2z0qz586j","query":"entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))"},"setting":{"type":"settings/rule.dlp","value":{"action":{"gmailAction":{"auditOnly":{"actionParams":{"applyExternalMessages":true,"applyInternalMessages":true}}}},"condition":{"contentCondition":"all_content.contains_word('secret')"},"displayName":"SecretShareGmail","state":"ACTIVE","triggers":["google.workspace.gmail.email.v1.send"]}}}
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies?alt=json
    method: POST
  response:
    body: |
      {
        "done": true,
        "response": {
          "@type": "type.googleapis.com/google.apps.cloudidentity.policies.v1main.Policy",
          "name": "policies/akajj264aom4fppfem",
          "customer": "customers/C02v7e0bo",
          "policyQuery": {
            "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
            "orgUnit": "orgUnits/03ph8a2z0qz586j",
            "sortOrder": 1
          },
          "setting": {
            "type": "settings/rule.dlp",
            "value": {
              "displayName": "SecretShareGmail",
              "triggers": [
                "google.workspace.gmail.email.v1.send"
              ],
              "condition": {
                "contentCondition": "all_content.contains_word('secret')"
              },
              "action": {
                "gmailAction": {
                  "auditOnly": {
                    "actionParams": {
                      "applyInternalMessages": true,
                      "applyExternalMessages": true
                    }
                  }
                }
              },
              "state": "ACTIVE",
              "createTime": "2026-02-02T17:51:14.865344Z",
              "updateTime": "2026-02-02T17:51:15.032307Z",
              "ruleTypeMetadata": {
                "dlpRuleMetadata": {
                  "alertSeverity": "LOW"
                }
              }
            }
          },
          "type": "ADMIN"
        }
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:15 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyInternalMessages": true,
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:15.032307Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:15 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyInternalMessages": true,
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:15.032307Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:17 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyInternalMessages": true,
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:15.032307Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:19 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: |
      {"name":"policies/akajj264aom4fppfem","policyQuery":{"orgUnit":"orgUnits/03ph8a2z0qz586j","query":"entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))","sortOrder":1},"setting":{"type":"settings/rule.dlp","value":{"action":{"gmailAction":{"auditOnly":{"actionParams":{"applyExternalMessages":true}}}},"condition":{"contentCondition":"all_content.contains_word('secret')"},"displayName":"SecretShareGmail","state":"ACTIVE","triggers":["google.workspace.gmail.email.v1.send"]}}}
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: PATCH
  response:
    body: |
      {
        "done": true,
        "response": {
          "@type": "type.googleapis.com/google.apps.cloudidentity.policies.v1main.Policy",
          "name": "policies/akajj264aom4fppfem",
          "customer": "customers/C02v7e0bo",
          "policyQuery": {
            "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
            "orgUnit": "orgUnits/03ph8a2z0qz586j",
            "sortOrder": 1
          },
          "setting": {
            "type": "settings/rule.dlp",
            "value": {
              "displayName": "SecretShareGmail",
              "triggers": [
                "google.workspace.gmail.email.v1.send"
              ],
              "condition": {
                "contentCondition": "all_content.contains_word('secret')"
              },
              "action": {
                "gmailAction": {
                  "auditOnly": {
                    "actionParams": {
                      "applyExternalMessages": true
                    }
                  }
                }
              },
              "state": "ACTIVE",
              "createTime": "2026-02-02T17:51:14.865344Z",
              "updateTime": "2026-02-02T17:51:21.902047Z",
              "ruleTypeMetadata": {
                "dlpRuleMetadata": {
                  "alertSeverity": "LOW"
                }
              }
            }
          },
          "type": "ADMIN"
        }
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:21 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:21.902047Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:22 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:21.902047Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:24 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: GET
  response:
    body: |
      {
        "name": "policies/akajj264aom4fppfem",
        "customer": "customers/C02v7e0bo",
        "policyQuery": {
          "query": "entity.org_units.exists(org_unit, org_unit.org_unit_id == orgUnitId('03ph8a2z0qz586j'))",
          "orgUnit": "orgUnits/03ph8a2z0qz586j",
          "sortOrder": 1
        },
        "setting": {
          "type": "settings/rule.dlp",
          "value": {
            "displayName": "SecretShareGmail",
            "triggers": [
              "google.workspace.gmail.email.v1.send"
            ],
            "condition": {
              "contentCondition": "all_content.contains_word('secret')"
            },
            "action": {
              "gmailAction": {
                "auditOnly": {
                  "actionParams": {
                    "applyExternalMessages": true
                  }
                }
              }
            },
            "state": "ACTIVE",
            "createTime": "2026-02-02T17:51:14.865344Z",
            "updateTime": "2026-02-02T17:51:21.902047Z",
            "ruleTypeMetadata": {
              "dlpRuleMetadata": {
                "alertSeverity": "LOW"
              }
            }
          }
        },
        "type": "ADMIN"
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:26 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
- request:
    body: ""
    form: {}
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - Terraform/1.5.7 (+https://www.terraform.io) Terraform-Plugin-SDK/2.38.1 terraform-provider-google-beta/acc
    url: https://cloudidentity.googleapis.com/v1beta1/policies/akajj264aom4fppfem?alt=json
    method: DELETE
  response:
    body: |
      {
        "done": true,
        "response": {
          "@type": "type.googleapis.com/google.protobuf.Empty"
        }
      }
    headers:
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Mon, 02 Feb 2026 17:51:28 GMT
      Server:
      - ESF
      Vary:
      - Origin
      - X-Origin
      - Referer
      X-Content-Type-Options:
      - nosniff
      X-Frame-Options:
      - SAMEORIGIN
      X-Xss-Protection:
      - "0"
    status: 200 OK
    code: 200
    duration: ""
