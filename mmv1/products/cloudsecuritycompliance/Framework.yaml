# Copyright 2024 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: Framework
description: Frameworks allow you to monitor and enforce compliance and security requirements. Manage compliance by assigning built-in or custom frameworks to resources.
references:
  api: "https://docs.cloud.google.com/security-command-center/docs/reference/cloudsecuritycompliance/rest/v1/organizations.locations.frameworks"
base_url: organizations/{{organization}}/locations/{{location}}/frameworks
update_mask: true
self_link: organizations/{{organization}}/locations/{{location}}/frameworks/{{framework_id}}
create_url: organizations/{{organization}}/locations/{{location}}/frameworks?frameworkId={{framework_id}}
update_verb: PATCH
id_format: organizations/{{organization}}/locations/{{location}}/frameworks/{{framework_id}}
import_format:
  - organizations/{{organization}}/locations/{{location}}/frameworks/{{framework_id}}
examples:
  - name: "cloudsecuritycompliance_framework_basic"
    primary_resource_id: "example"
    vars:
      framework_name: "example-framework"
    test_env_vars:
      org_id: "ORG_ID"
autogen_status: RnJhbWV3b3Jr
custom_code:
  encoder: "templates/terraform/encoders/cloudsecuritycompliance_framework.go.tmpl"
parameters:
  - name: organization
    type: String
    description: Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: location
    type: String
    description: Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: frameworkId
    type: String
    description: |-
      ID of the framework.
      This is not the full name of the framework.
      This is the last part of the full name of the framework.
    immutable: true
    url_param_only: true
    required: true
properties:
  - name: category
    type: Array
    description: The category of the framework.
    item_type:
      type: String
    output: true
  - name: cloudControlDetails
    type: Array
    description: |-
      The details of the cloud controls directly added without any grouping in
      the framework.
    item_type:
      type: NestedObject
      properties:
        - name: majorRevisionId
          type: String
          description: Major revision of cloudcontrol
          required: true
        - name: name
          type: String
          description: |-
            The name of the CloudControl in the format:
            “organizations/{organization}/locations/{location}/cloudControls/{cloud-control}”
          required: true
        - name: parameters
          type: Array
          description: |-
            Parameters is a key-value pair that is required by the CloudControl. The
            specification of these parameters will be present in cloudcontrol.Eg: {
            "name": "location","value": "us-west-1"}.
          item_type:
            type: NestedObject
            properties:
              - name: name
                type: String
                description: The name of the parameter.
                required: true
              - name: parameterValue
                type: NestedObject
                description: Possible parameter value types.
                required: true
                properties:
                  - name: boolValue
                    type: Boolean
                    description: Represents a boolean value.
                  - name: numberValue
                    type: Double
                    description: Represents a double value.
                  - name: stringListValue
                    type: NestedObject
                    description: A list of strings.
                    properties:
                      - name: values
                        type: Array
                        description: The strings in the list.
                        required: true
                        item_type:
                          type: String
                  - name: stringValue
                    type: String
                    description: Represents a string value.
                  - name: oneofValue
                    type: NestedObject
                    description: Sub-parameter values.
                    properties:
                      - name: name
                        type: String
                        description: The name of the parameter.
                      - name: parameterValue
                        type: NestedObject
                        description: The value of the parameter.
                        properties:
                          - name: boolValue
                            type: Boolean
                            description: Represents a boolean value.
                          - name: numberValue
                            type: Double
                            description: Represents a double value.
                          - name: stringListValue
                            type: NestedObject
                            description: A list of strings.
                            properties:
                              - name: values
                                type: Array
                                description: The strings in the list.
                                required: true
                                item_type:
                                  type: String
                          - name: stringValue
                            type: String
                            description: Represents a string value.
  - name: description
    type: String
    description: The description of the framework. The maximum length is 2000 characters.
  - name: displayName
    type: String
    description: Display name of the framework. The maximum length is 200 characters.
  - name: majorRevisionId
    type: String
    description: Major revision of the framework incremented in ascending order.
    output: true
  - name: name
    type: String
    description: |-
      Identifier. The name of the framework.
      Format:
      organizations/{organization}/locations/{{location}}/frameworks/{framework_id}
    output: true
  - name: supportedCloudProviders
    type: Array
    description: cloud providers supported
    output: true
    item_type:
      type: String
  - name: supportedEnforcementModes
    type: Array
    description: The supported enforcement modes of the framework.
    output: true
    item_type:
      type: String
  - name: supportedTargetResourceTypes
    type: Array
    description: target resource types supported by the Framework.
    output: true
    item_type:
      type: String
  - name: type
    type: String
    description: |-
      The type of the framework. The default is TYPE_CUSTOM.
      Possible values:
      BUILT_IN
      CUSTOM
    output: true
