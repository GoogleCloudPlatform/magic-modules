# Copyright 2024 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: 'SecurityFeedback'
description: |
  Represents a feedback report from an Advanced API Security customer.
  Manages customer feedback about ML models.
references:
  guides:
    'Create a SecurityFeedback': 'https://docs.cloud.google.com/apigee/docs/api-security/abuse-detection#exclude-traffic-from-abuse-detection'
  api: 'https://cloud.google.com/apigee/docs/reference/apis/apigee/rest/v1/organizations.securityFeedback/create'
base_url: '{{org_id}}/securityFeedback'
self_link: '{{org_id}}/securityFeedback/{{feedback_id}}'
create_url: '{{org_id}}/securityFeedback?security_feedback_id={{feedback_id}}'
update_verb: 'PATCH'
import_format:
  - '{{org_id}}/securityFeedback/{{feedback_id}}'
  - '{{org_id}}/{{feedback_id}}'
custom_code:
  custom_import: "templates/terraform/custom_import/apigee_security_feedback.go.tmpl"
examples:
  - name: 'apigee_security_feedback_basic'
    vars:
      security_feedback_id: 'my-feedback'
    exclude_test: true
  - name: 'apigee_security_feedback_basic_test'
    primary_resource_id: 'security_feedback'
    test_env_vars:
      org_id: 'ORG_ID'
      billing_account: 'BILLING_ACCT'
    exclude_docs: true
    external_providers: ["time"]
parameters:
  - name: 'orgId'
    type: String
    description: |
      The Apigee Organization associated with the Apigee Security Feedback,
      in the format `organizations/{{org_name}}`.
    url_param_only: true
    required: true
    immutable: true
  - name: 'feedbackId'
    type: String
    description: |
      Resource ID of the security feedback.
    required: true
    immutable: true
    url_param_only: true
properties:
  - name: 'name'
    type: String
    description: |
      Name of the security feedback resource,
      in the format `organizations/{{org_name}}/securityFeedback/{{feedback_id}}`.
    output: true
  - name: 'displayName'
    type: String
    description: The display name of the feedback.
  - name: 'feedbackContexts'
    type: Array
    description: |
      One or more attribute/value pairs for constraining the feedback.
    required: true
    item_type:
      type: NestedObject
      properties:
        - name: attribute
          type: Enum
          description: |
            The attribute the user is providing feedback about.
          required: true
          enum_values:
            - 'ATTRIBUTE_ENVIRONMENTS'
            - 'ATTRIBUTE_IP_ADDRESS_RANGES'
        - name: values
          type: Array
          description: |
            The values of the attribute the user is providing feedback about, separated by commas.
          required: true
          item_type:
            type: String
  - name: 'feedbackType'
    type: Enum
    description: The type of feedback being submitted.
    required: true
    enum_values:
      - 'EXCLUDED_DETECTION'
  - name: 'createTime'
    type: String
    description: The time when this specific feedback id was created.
    output: true
  - name: 'updateTime'
    type: String
    description: The time when this specific feedback id was updated.
    output: true
  - name: 'reason'
    type: Enum
    description: The reason for the feedback.
    enum_values:
      - 'INTERNAL_SYSTEM'
      - 'NON_RISK_CLIENT'
      - 'NAT'
      - 'PENETRATION_TEST'
      - 'OTHER'
  - name: 'comment'
    type: String
    description: Optional text the user can provide for additional, unstructured context.
