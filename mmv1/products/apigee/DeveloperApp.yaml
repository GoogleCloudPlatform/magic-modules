# Copyright 2025 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: "DeveloperApp"
description: |
  A `DeveloperApp` in Apigee.
references:
  guides:
    "Registering apps and managing API keys": "https://cloud.google.com/apigee/docs/api-platform/publish/registering-apps-and-managing-api-keys"
  api: "https://cloud.google.com/apigee/docs/reference/apis/apigee/rest/v1/organizations.developers.apps"
base_url: "{{org_id}}/developers/{{developer_email}}/apps"
self_link: "{{org_id}}/developers/{{developer_email}}/apps/{{name}}"
delete_url: "{{org_id}}/developers/{{developer_email}}/apps/{{name}}"
update_mask: false
immutable: false
import_format:
  - "{{org_id}}/developers/{{developer_email}}/apps/{{name}}"
  - "{{org_id}}/{{developer_email}}/{{name}}"
custom_code:
  custom_import: "templates/terraform/custom_import/apigee_developer_app.go.tmpl"
examples:
  - name: "apigee_developer_app_basic"
    vars:
      instance_name: "my-instance"
      developer_email: "john.doe@acme.com"
      app_name: "my-app"
    exclude_test: true
  - name: "apigee_developer_app_basic_test"
    primary_resource_id: "apigee_developer_app"
    test_env_vars:
      org_id: "ORG_ID"
      billing_account: "BILLING_ACCT"
    exclude_docs: true
    external_providers: ["time"]
  - name: "apigee_developer_app_with_attributes"
    vars:
      instance_name: "my-instance"
      developer_email: "john.doe@acme.com"
      app_name: "my-app"
    exclude_test: true
  - name: "apigee_developer_app_with_attributes_test"
    primary_resource_id: "apigee_developer_app"
    test_env_vars:
      org_id: "ORG_ID"
      billing_account: "BILLING_ACCT"
    exclude_docs: true
    external_providers: ["time"]
parameters:
  - name: "orgId"
    type: String
    description: |
      The Apigee Organization associated with the Apigee developer,
      in the format `organizations/{{org_name}}`.
    url_param_only: true
    required: true
    immutable: true
  - name: "developerEmail"
    type: String
    description: |
      The email of the developer.
    url_param_only: true
    required: true
    immutable: true
properties:
  - name: "appId"
    type: String
    description: |
      ID of the developer app. This ID is not user specified but is automatically generated on app creation. appId is a UUID.
    output: true
  - name: "attributes"
    type: Array
    description: |
      List of attributes for the developer app.
    item_type:
      type: NestedObject
      properties:
        - name: "name"
          type: String
          description: |
            Key of the attribute
        - name: "value"
          type: String
          description: |
            Value of the attribute
  - name: "callbackUrl"
    type: String
    description: |
      Callback URL used by OAuth 2.0 authorization servers to communicate authorization codes back to developer apps.
  - name: "createdAt"
    type: String
    description: |
      Output only. Time the developer app was created in milliseconds since epoch.
    output: true
  - name: "credentials"
    type: Array
    description: |
      Output only. Set of credentials for the developer app consisting of the consumer key/secret pairs associated with the API products.
    output: true
    item_type:
      type: NestedObject
      properties:
        - name: "apiProducts"
          type: Array
          description: |
            A list of API products to be associated with the credential.
          output: true
          item_type:
            type: NestedObject
            properties:
              - name: "apiproduct"
                type: String
                description: |
                  Name of the API product.
                output: true
              - name: "status"
                type: String
                description: |
                  Status of the API product. Valid values are approved or revoked.
                output: true
        - name: "attributes"
          type: Array
          description: |
            A list of attributes
          output: true
          item_type:
            type: NestedObject
            properties:
              - name: "name"
                type: String
                description: |
                  Key of the attribute
                output: true
              - name: "value"
                type: String
                description: |
                  Value of the attribute
                output: true
        - name: "consumerKey"
          type: String
          description: |
            The consumer key for the credential.
          output: true
        - name: "consumerSecret"
          type: String
          description: |
            The consumer secret for the credential.
          output: true
        - name: "expiresAt"
          type: String
          description: |
            The time at which the credential expires.
          output: true
        - name: "issuedAt"
          type: String
          description: |
            Time the credential was issued in milliseconds since epoch.
          output: true
        - name: "scopes"
          type: Array
          description: |
            List of scopes to apply to the app. Specified scopes must already exist on the API product that you associate with the app.
          output: true
          item_type:
            type: String
        - name: "status"
          type: String
          description: |
            Status of the credential. Valid values include approved or revoked.
          output: true
  - name: "developerId"
    type: String
    description: |
      ID of the developer.
    output: true
  - name: "lastModifiedAt"
    type: String
    description: |
      Output only. Time the developer app was modified in milliseconds since epoch.
    output: true
  - name: "name"
    type: String
    description: |
      Name of the developer app.
    required: true
  - name: "scopes"
    type: Array
    description: |
      Scopes to apply to the developer app. The specified scopes must already exist for the API product that you associate with the developer app.
    item_type:
      type: String
  - name: "status"
    type: String
    description: |
      Status of the credential. Valid values include approved or revoked. After creation, this field can't be changed in this resource.
    default_from_api: true
    immutable: true
  - name: "keyExpiresIn"
    type: String
    description: |
      Expiration time, in milliseconds, for the consumer key that is generated for the developer app. If not set or left to the default value of -1, the API key never expires. The expiration time can't be updated after it is set.
    immutable: true
  - name: "apiProducts"
    type: Array
    description: |
      List of API products associated with the developer app.
    item_type:
      type: String
