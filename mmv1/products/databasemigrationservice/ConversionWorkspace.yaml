# Copyright 2024 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: 'ConversionWorkspace'
description: 'A conversion workspace is used to convert a database from one engine to another.'
references:
  guides:
    'Database Migration': 'https://cloud.google.com/database-migration/docs/'
  api: 'https://cloud.google.com/database-migration/docs/reference/rest/v1/projects.locations.conversionWorkspaces'
docs:
base_url: 'projects/{{project}}/locations/{{location}}/conversionWorkspaces'
self_link: 'projects/{{project}}/locations/{{location}}/conversionWorkspaces/{{conversion_workspace_id}}'
create_url: 'projects/{{project}}/locations/{{location}}/conversionWorkspaces?conversionWorkspaceId={{conversion_workspace_id}}'
update_verb: 'PATCH'
update_mask: true
import_format:
  - 'projects/{{project}}/locations/{{location}}/conversionWorkspaces/{{conversion_workspace_id}}'
timeouts:
  insert_minutes: 60
  update_minutes: 60
  delete_minutes: 60
autogen_async: true
async:
  actions: ['create', 'delete', 'update']
  type: 'OpAsync'
  operation:
    base_url: '{{op_id}}'
    timeouts:
      insert_minutes: 60
      update_minutes: 60
      delete_minutes: 60
  result:
    resource_inside_response: false
custom_code:
examples:
  - name: 'database_migration_service_conversion_workspace_basic'
    primary_resource_id: 'example'
    vars:
      conversion_workspace_id: 'my-conversion-workspace'
    skip_test: true
  - name: 'database_migration_service_conversion_workspace_full'
    primary_resource_id: 'example_full'
    vars:
      conversion_workspace_id: 'my-conversion-workspace-full'
    skip_test: true
parameters:
  - name: 'conversionWorkspaceId'
    type: String
    description: |
      The ID of the conversion workspace.
    url_param_only: true
    required: true
    immutable: true
  - name: 'location'
    type: String
    description: |
      The location where the conversion workspace should reside.
    url_param_only: true
    immutable: true
    required: true
properties:
  - name: 'name'
    type: String
    description: |
      The resource name (URI) of the conversion workspace.
    output: true
  - name: 'displayName'
    type: String
    description: |
      The display name for the conversion workspace.
  - name: 'source'
    type: NestedObject
    description: |
      The source database engine information.
    required: true
    immutable: true
    properties:
      - name: 'engine'
        type: Enum
        description: |
          The database engine type.
        required: true
        enum_values:
          - 'MYSQL'
          - 'POSTGRESQL'
          - 'SQLSERVER'
          - 'ORACLE'
      - name: 'version'
        type: String
        description: |
          The database engine version.
        required: true
  - name: 'destination'
    type: NestedObject
    description: |
      The destination database engine information.
    required: true
    immutable: true
    properties:
      - name: 'engine'
        type: Enum
        description: |
          The database engine type.
        required: true
        enum_values:
          - 'MYSQL'
          - 'POSTGRESQL'
          - 'SQLSERVER'
          - 'ORACLE'
      - name: 'version'
        type: String
        description: |
          The database engine version.
        required: true
  - name: 'globalSettings'
    type: KeyValuePairs
    description: |
      A generic list of settings for the workspace. The settings are database pair dependant and can indicate default behavior for the mapping rules engine or turn on or off specific features. Such examples can be: convert_foreign_key_to_interleave=true, skip_triggers=false, ignore_non_table_synonyms=true
    custom_flatten: 'templates/terraform/custom_flatten/database_migration_service_conversion_workspace_global_settings.go.tmpl'
  - name: 'effectiveGlobalSettings'
    api_name: globalSettings
    type: KeyValuePairs
    output: true
    description: |
      A generic list of settings for the workspace. The settings are database pair dependant and can indicate default behavior for the mapping rules engine or turn on or off specific features. Such examples can be: convert_foreign_key_to_interleave=true, skip_triggers=false, ignore_non_table_synonyms=true
  - name: 'hasUncommittedChanges'
    type: Boolean
    description: |
      Whether the workspace has uncommitted changes (changes which were made after the workspace was committed).
    output: true
  - name: 'latestCommitId'
    type: String
    description: |
      The latest commit ID.
    output: true
  - name: 'latestCommitTime'
    type: Time
    description: |
      The timestamp when the workspace was committed.
    output: true
  - name: 'createTime'
    type: Time
    description: |
      The timestamp when the workspace resource was created.
    output: true
  - name: 'updateTime'
    type: Time
    description: |
      The timestamp when the workspace resource was last updated.
    output: true
