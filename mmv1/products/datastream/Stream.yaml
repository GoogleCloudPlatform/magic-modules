--- !ruby/object:Api::Resource
  name: 'Stream'
  base_url: "projects/{{project}}/locations/{{location}}/streams"
  create_url: "projects/{{project}}/locations/{{location}}/streams?streamId={{stream_id}}"
  self_link: "projects/{{project}}/locations/{{location}}/streams/{{stream_id}}"
  update_verb: :PATCH
  update_mask: true
  references: !ruby/object:Api::Resource::ReferenceLinks
    guides:
      'Official Documentation': 'https://cloud.google.com/datastream/docs/create-a-stream'
    api: 'https://cloud.google.com/datastream/docs/reference/rest/v1/projects.locations.streams'
  description: |
    A resource representing streaming data from a source to a destination.
  parameters:
    - !ruby/object:Api::Type::String
      name: streamId
      description: |-
        The stream identifier.
      required: true
      input: true
      url_param_only: true
    - !ruby/object:Api::Type::String
      name: 'location'
      description: |
        The name of the location this stream is located in.
      required: true
      input: true
      url_param_only: true
  properties:
    - !ruby/object:Api::Type::String
      name: 'name'
      output: true
      description: The stream's name.
    - !ruby/object:Api::Type::KeyValuePairs
      name: 'labels'
      description: Labels.
    - !ruby/object:Api::Type::String
      name: 'displayName'
      required: true
      description: Display name.
    - !ruby/object:Api::Type::NestedObject
      name: 'sourceConfig'
      required: true
      description: |
        Source connection profile configuration.
      properties:
        - !ruby/object:Api::Type::String
          name: 'sourceConnectionProfile'
          input: true
          required: true
          description: |
            Source connection profile resource. Format: projects/{project}/locations/{location}/connectionProfiles/{name}
        - !ruby/object:Api::Type::NestedObject
          name: 'mysqlSourceConfig'
          allow_empty_object: true
          send_empty_value: true
          required: true
          description: |
            MySQL data source configuration.
          properties:
            - !ruby/object:Api::Type::NestedObject
              name: 'includeObjects'
              description: |
                MySQL objects to retrieve from the source.
              properties:
                - !ruby/object:Api::Type::Array
                  name: 'mysqlDatabases'
                  required: true
                  min_size: 1
                  description: |
                    MySQL databases on the server
                  item_type: !ruby/object:Api::Type::NestedObject
                    description: |
                      MySQL database.
                    properties:
                      - !ruby/object:Api::Type::String
                        name: 'database'
                        required: true
                        description: |
                          Database name.
                      - !ruby/object:Api::Type::Array
                        name: 'mysqlTables'
                        min_size: 1
                        description: |
                          Tables in the database.
                        item_type: !ruby/object:Api::Type::NestedObject
                          description: |
                            MySQL table.
                          properties:
                            - !ruby/object:Api::Type::String
                              name: 'table'
                              required: true
                              description: |
                                Table name.
                            - !ruby/object:Api::Type::Array
                              name: 'mysqlColumns'
                              min_size: 1
                              description: |
                                MySQL columns in the schema. When unspecified as part of include/exclude objects, includes/excludes everything.
                              item_type: !ruby/object:Api::Type::NestedObject
                                description: |
                                  MySQL Column.
                                properties:
                                  - !ruby/object:Api::Type::String
                                    name: 'column'
                                    description: |
                                      Column name.
                                  - !ruby/object:Api::Type::String
                                    name: 'dataType'
                                    description: |
                                      The MySQL data type. Full data types list can be found here:
                                      https://dev.mysql.com/doc/refman/8.0/en/data-types.html
                                  - !ruby/object:Api::Type::Integer
                                    name: 'length'
                                    output: true
                                    description: |
                                      Column length.
                                  - !ruby/object:Api::Type::String
                                    name: 'collation'
                                    description: |
                                      Column collation.
                                  - !ruby/object:Api::Type::Boolean
                                    name: 'primaryKey'
                                    description: |
                                      Whether or not the column represents a primary key.
                                  - !ruby/object:Api::Type::Boolean
                                    name: 'nullable'
                                    description: |
                                      Whether or not the column can accept a null value.
                                  - !ruby/object:Api::Type::Integer
                                    name: 'ordinalPosition'
                                    description: |
                                      The ordinal position of the column in the table.
            - !ruby/object:Api::Type::NestedObject
              name: 'excludeObjects'
              description: |
                MySQL objects to exclude from the stream.
              properties:
                - !ruby/object:Api::Type::Array
                  name: 'mysqlDatabases'
                  required: true
                  min_size: 1
                  description: |
                    MySQL databases on the server
                  item_type: !ruby/object:Api::Type::NestedObject
                    description: |
                      MySQL database.
                    properties:
                      - !ruby/object:Api::Type::String
                        name: 'database'
                        required: true
                        description: |
                          Database name.
                      - !ruby/object:Api::Type::Array
                        name: 'mysqlTables'
                        min_size: 1
                        description: |
                          Tables in the database.
                        item_type: !ruby/object:Api::Type::NestedObject
                          description: |
                            MySQL table.
                          properties:
                            - !ruby/object:Api::Type::String
                              name: 'table'
                              required: true
                              description: |
                                Table name.
                            - !ruby/object:Api::Type::Array
                              name: 'mysqlColumns'
                              min_size: 1
                              description: |
                                MySQL columns in the schema. When unspecified as part of include/exclude objects, includes/excludes everything.
                              item_type: !ruby/object:Api::Type::NestedObject
                                description: |
                                  MySQL Column.
                                properties:
                                  - !ruby/object:Api::Type::String
                                    name: 'column'
                                    description: |
                                      Column name.
                                  - !ruby/object:Api::Type::String
                                    name: 'dataType'
                                    description: |
                                      The MySQL data type. Full data types list can be found here:
                                      https://dev.mysql.com/doc/refman/8.0/en/data-types.html
                                  - !ruby/object:Api::Type::Integer
                                    name: 'length'
                                    output: true
                                    description: |
                                      Column length.
                                  - !ruby/object:Api::Type::String
                                    name: 'collation'
                                    description: |
                                      Column collation.
                                  - !ruby/object:Api::Type::Boolean
                                    name: 'primaryKey'
                                    description: |
                                      Whether or not the column represents a primary key.
                                  - !ruby/object:Api::Type::Boolean
                                    name: 'nullable'
                                    description: |
                                      Whether or not the column can accept a null value.
                                  - !ruby/object:Api::Type::Integer
                                    name: 'ordinalPosition'
                                    description: |
                                      The ordinal position of the column in the table.
            - !ruby/object:Api::Type::Integer
              name: 'maxConcurrentCdcTasks'
              send_empty_value: true
              description: |
                Maximum number of concurrent CDC tasks. The number should be non negative.
                If not set (or set to 0), the system's default value will be used.
    - !ruby/object:Api::Type::NestedObject
      name: 'destinationConfig'
      required: true
      description: |
        Destination connection profile configuration.
      properties:
        - !ruby/object:Api::Type::String
          name: 'destinationConnectionProfile'
          input: true
          required: true
          description: |
            Destination connection profile resource. Format: projects/{project}/locations/{location}/connectionProfiles/{name}
        - !ruby/object:Api::Type::NestedObject
          name: 'gcsDestinationConfig'
          exactly_one_of:
            - destination_config.0.gcs_destination_config
            - destination_config.0.bigquery_destination_config
          description: |
            A configuration for how data should be loaded to Cloud Storage.
          properties:
            - !ruby/object:Api::Type::String
              name: 'path'
              description: |
                Path inside the Cloud Storage bucket to write data to.
            - !ruby/object:Api::Type::Integer
              name: 'fileRotationMb'
              description: |
                The maximum file size to be saved in the bucket.
            - !ruby/object:Api::Type::String
              name: 'fileRotationInterval'
              description: |
                The maximum duration for which new events are added before a file is closed and a new file is created.
                A duration in seconds with up to nine fractional digits, terminated by 's'. Example: "3.5s". Defaults to 900s.
            - !ruby/object:Api::Type::NestedObject
              name: 'avroFileFormat'
              exactly_one_of:
                - destination_config.0.gcs_destination_config.0.avro_file_format
                - destination_config.0.gcs_destination_config.0.json_file_format
              allow_empty_object: true
              send_empty_value: true
              description: |
                AVRO file format configuration.
              properties: []
            - !ruby/object:Api::Type::NestedObject
              name: 'jsonFileFormat'
              exactly_one_of:
                - destination_config.0.gcs_destination_config.0.avro_file_format
                - destination_config.0.gcs_destination_config.0.json_file_format
              description: |
                JSON file format configuration.
              properties:
                - !ruby/object:Api::Type::Enum
                  name: 'schemaFileFormat'
                  description: |
                    The schema file format along JSON data files.
                  values:
                    - NO_SCHEMA_FILE
                    - AVRO_SCHEMA_FILE
                - !ruby/object:Api::Type::Enum
                  name: 'compression'
                  description: |
                    Compression of the loaded JSON file.
                  values:
                    - NO_COMPRESSION
                    - GZIP
        - !ruby/object:Api::Type::NestedObject
          name: 'bigqueryDestinationConfig'
          exactly_one_of:
            - destination_config.0.gcs_destination_config
            - destination_config.0.bigquery_destination_config
          description: |
            A configuration for how data should be loaded to Cloud Storage.
          properties:
            - !ruby/object:Api::Type::String
              name: 'dataFreshness'
              description: |
                The guaranteed data freshness (in seconds) when querying tables created by the stream.
                Editing this field will only affect new tables created in the future, but existing tables
                will not be impacted. Lower values mean that queries will return fresher data, but may result in higher cost.
                A duration in seconds with up to nine fractional digits, terminated by 's'. Example: "3.5s". Defaults to 900s.
            - !ruby/object:Api::Type::NestedObject
              name: 'singleTargetDataset'
              exactly_one_of:
                - destination_config.0.bigquery_destination_config.0.single_target_dataset
                - destination_config.0.bigquery_destination_config.0.source_hierarchy_datasets
              description: |
                A single target dataset to which all data will be streamed.
              properties:
                - !ruby/object:Api::Type::String
                  name: 'datasetId'
                  required: true
                  description: |
                    Dataset ID in the format projects/{project}/datasets/{dataset_id}
            - !ruby/object:Api::Type::NestedObject
              name: 'sourceHierarchyDatasets'
              exactly_one_of:
                - destination_config.0.bigquery_destination_config.0.single_target_dataset
                - destination_config.0.bigquery_destination_config.0.source_hierarchy_datasets
              description: |
                Destination datasets are created so that hierarchy of the destination data objects matches the source hierarchy.
              properties:
                - !ruby/object:Api::Type::NestedObject
                  name: 'datasetTemplate'
                  required: true
                  description: |
                    Dataset template used for dynamic dataset creation.
                  properties:
                    - !ruby/object:Api::Type::String
                      name: 'location'
                      required: true
                      description: |
                        The geographic location where the dataset should reside.
                        See https://cloud.google.com/bigquery/docs/locations for supported locations.
                    - !ruby/object:Api::Type::String
                      name: 'datasetIdPrefix'
                      description: |
                        If supplied, every created dataset will have its name prefixed by the provided value.
                        The prefix and name will be separated by an underscore. i.e. _.
                    - !ruby/object:Api::Type::String
                      name: 'kmsKeyName'
                      input: true
                      description: |
                        Describes the Cloud KMS encryption key that will be used to protect destination BigQuery
                        table. The BigQuery Service Account associated with your project requires access to this
                        encryption key. i.e. projects/{project}/locations/{location}/keyRings/{key_ring}/cryptoKeys/{cryptoKey}.
                        See https://cloud.google.com/bigquery/docs/customer-managed-encryption for more information.
    - !ruby/object:Api::Type::String
      name: 'state'
      description: The state of the stream.
      output: true
    - !ruby/object:Api::Type::NestedObject
      name: 'backfillAll'
      exactly_one_of:
        - backfill_all
        - backfill_none
      allow_empty_object: true
      send_empty_value: true
      description: |
        Backfill strategy to automatically backfill the Stream's objects. Specific objects can be excluded.
      properties:
        - !ruby/object:Api::Type::NestedObject
          name: 'mysqlExcludedObjects'
          description: |
            MySQL data source objects to avoid backfilling.
          properties:
            - !ruby/object:Api::Type::Array
              name: 'mysqlDatabases'
              required: true
              min_size: 1
              description: |
                MySQL databases on the server
              item_type: !ruby/object:Api::Type::NestedObject
                description: |
                  MySQL database.
                properties:
                  - !ruby/object:Api::Type::String
                    name: 'database'
                    required: true
                    description: |
                      Database name.
                  - !ruby/object:Api::Type::Array
                    name: 'mysqlTables'
                    min_size: 1
                    description: |
                      Tables in the database.
                    item_type: !ruby/object:Api::Type::NestedObject
                      description: |
                        MySQL table.
                      properties:
                        - !ruby/object:Api::Type::String
                          name: 'table'
                          required: true
                          description: |
                            Table name.
                        - !ruby/object:Api::Type::Array
                          name: 'mysqlColumns'
                          min_size: 1
                          description: |
                            MySQL columns in the schema. When unspecified as part of include/exclude objects, includes/excludes everything.
                          item_type: !ruby/object:Api::Type::NestedObject
                            description: |
                              MySQL Column.
                            properties:
                              - !ruby/object:Api::Type::String
                                name: 'column'
                                description: |
                                  Column name.
                              - !ruby/object:Api::Type::String
                                name: 'dataType'
                                description: |
                                  The MySQL data type. Full data types list can be found here:
                                  https://dev.mysql.com/doc/refman/8.0/en/data-types.html
                              - !ruby/object:Api::Type::Integer
                                name: 'length'
                                output: true
                                description: |
                                  Column length.
                              - !ruby/object:Api::Type::String
                                name: 'collation'
                                description: |
                                  Column collation.
                              - !ruby/object:Api::Type::Boolean
                                name: 'primaryKey'
                                description: |
                                  Whether or not the column represents a primary key.
                              - !ruby/object:Api::Type::Boolean
                                name: 'nullable'
                                description: |
                                  Whether or not the column can accept a null value.
                              - !ruby/object:Api::Type::Integer
                                name: 'ordinalPosition'
                                description: |
                                  The ordinal position of the column in the table.
    - !ruby/object:Api::Type::NestedObject
      name: 'backfillNone'
      exactly_one_of:
        - backfill_all
        - backfill_none
      allow_empty_object: true
      send_empty_value: true
      description: |
        Backfill strategy to disable automatic backfill for the Stream's objects.
      properties: []
    - !ruby/object:Api::Type::String
      name: 'customerManagedEncryptionKey'
      input: true
      description: |
        A reference to a KMS encryption key. If provided, it will be used to encrypt the data. If left blank, data
        will be encrypted using an internal Stream-specific encryption key provisioned through KMS.
