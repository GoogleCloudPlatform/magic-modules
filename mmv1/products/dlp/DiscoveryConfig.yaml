# Copyright 2023 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

--- !ruby/object:Api::Resource
# API resource name
name: 'DiscoverConfig'
base_url: '{{parent}}/discoveryConfigs'
self_link: '{{parent}}/discoveryConfigs'
create_url: '{{parent}}/discoveryConfigs'
create_verb: POST
update_mask: true
# Resource description for the provider documentation.
description: |
  Configuration for discovery to scan resources for profile generation. Only one discovery configuration may exist per organization, folder, or project. 
references: !ruby/object:Api::Resource::ReferenceLinks
  guides:
    'Schedule inspection scan': 'https://cloud.google.com/dlp/docs/schedule-inspection-scan'
  api: 'https://cloud.google.com/dlp/docs/reference/rest/v2/projects.locations.discoveryConfigs'
id_format: '{{parent}}/discoveryConfigs/{{name}}'
parameters:
  - !ruby/object:Api::Type::String
    name: 'parent'
    description: |
      The parent of the inspect template in any of the following formats:

      * `projects/{{project}}`
      * `projects/{{project}}/locations/{{location}}`
      * `organizations/{{organization_id}}`
      * `organizations/{{organization_id}}/locations/{{location}}`
    required: true
    immutable: true
    url_param_only: true
properties:
  - !ruby/object:Api::Type::NestedObject
    name: 'DiscoveryConfig'
    description: Configuration for discovery to scan resources for profile generation. Only one discovery configuration may exists per organization, folder, or porject. 
    properties:
      - !ruby/object:Api:Type:String 
        name: name
        description: Unique resource name for the DiscoveryConfig, assigned by the service when the DiscoveryConfig is created.
      - !ruby/object:Api:Type:String
        name: displayName
        description: Display Name (max 1000 Chars)
      - !ruby/object:Api:Type:NestedObject 
        name: 'OrgConfig'
        properties: 
        - !ruby/object:Api:Type:String
          name: projectId
          description: The project that will run the scan. The DLP service account that exists within this project must have access to all resources that are profiled, and the cloud DLP API must be enabled. 
        - !ruby/object:Api:Type:NestedObject
          name: location 
          description: The data to scan folder org or project 
          properties: 
          - !ruby/object:Api:Type:String
          name: organizationId 
          description: The ID of an organization to scan 
          - !ruby/object:Api:Type:String
          name: folderId
          description: The ID for the folder within an organization to scan 
      - !ruby/object:Api:Type:String 
        name: 'inspectTemplates[]'
        description: Detection logic for profile generation 
      - !ruby/object:Api:Type:NestedObject 
        name: 'actions[]'
        description: Actions to execute at the completion of scanning
        properties: 
        - !ruby/object:Api:Type:NestedObject
          name:  exportData
          description: Export data profiles into a provided location 
          properties: 
          - !
      - !ruby/object:Api:Type:String 
        name: 


# Overrides the HTTP verb used to create a new resource.
# Allowed values: :POST, :PUT, :PATCH. Default: :POST
# create_verb: :POST

# Overrides the URL for the resource's standard Update method. (If unset, the
# self_link URL is used by default.) https://google.aip.dev/134
# Terraform field names enclosed in double curly braces are replaced with
# the field values from the resource at runtime.
# update_url: 'projects/{{project}}/locations/{{location}}/resourcenames/{{name}}'
# The HTTP verb used to update a resource. Allowed values: :POST, :PUT, :PATCH. Default: :PUT.


# Overrides the URL for the resource's standard Delete method. (If unset, the
# self_link URL is used by default.) https://google.aip.dev/135
# Terraform field names enclosed in double curly braces are replaced with
# the field values from the resource at runtime.
# delete_url: 'projects/{{project}}/locations/{{location}}/resourcenames/{{name}}'
# Overrides the HTTP verb used to delete a resource.
# Allowed values: :POST, :PUT, :PATCH, :DELETE. Default: :DELETE
# delete_verb: :DELETE

# If true, code for handling long-running operations is generated along with
# the resource. If false, that code is not generated.
autogen_async: true
# Sets parameters for handling operations returned by the API.
async: !ruby/object:Api::OpAsync
  # Overrides which API calls return operations. Default: ['create',
  # 'update', 'delete']
  # actions: ['create', 'update', 'delete']
  operation: !ruby/object:Api::OpAsync::Operation
    base_url: '{{op_id}}'

  # If true, the provider sets the resource's Terraform ID after the resource is created,
  # taking into account values that are set by the API at create time. This is only possible
  # when the completed operation's JSON includes the created resource in the "response" field.
  # If false (or unset), the provider sets the resource's Terraform ID before the resource is
  # created, based only on the resource configuration.
  # result: !ruby/object:Api::OpAsync::Result
  #   resource_inside_response: true

# All resources (of all kinds) that share a mutex value block rather than
# executing concurrent API requests.
# Terraform field names enclosed in double curly braces are replaced with
# the field values from the resource at runtime.
# mutex: RESOURCE_NAME/{{name}}

parameters:
  - !ruby/object:Api::Type::String
    name: 'location'
    required: true
    immutable: true
    url_param_only: true
    description: |
      LOCATION_DESCRIPTION      
  - !ruby/object:Api::Type::String
    name: 'name'
    required: true
    immutable: true
    url_param_only: true
    description: |
      NAME_DESCRIPTION      

properties:
  # Fields go here
