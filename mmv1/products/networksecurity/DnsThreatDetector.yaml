# Copyright 2025 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: "DnsThreatDetector"
description: |
  DNS Armor is a fully-managed service that provides DNS-layer security for your Google Cloud workloads.
references:
  guides:
    "DNS Threat Detector": "https://cloud.google.com/dns/docs/threat-detection"
  api: "https://cloud.google.com/dns/docs/create-threat-detector"
docs:
id_format: "projects/{{project}}/locations/{{location}}/dnsThreatDetectors/{{name}}"
base_url: "projects/{{project}}/locations/{{location}}/dnsThreatDetectors"
self_link: "projects/{{project}}/locations/{{location}}/dnsThreatDetectors/{{name}}"
create_url: "projects/{{project}}/locations/{{location}}/dnsThreatDetectors?dnsThreatDetectorId={{name}}"
update_verb: "PATCH"
update_mask: true
import_format:
  - "projects/{{project}}/locations/{{location}}/dnsThreatDetectors/{{name}}"
  - "{{name}}"
timeouts:
  insert_minutes: 20
  update_minutes: 20
  delete_minutes: 20
custom_code:
examples:
  - name: "network_security_dns_threat_detector_basic"
    primary_resource_id: "default"
    vars:
      resource_name: "my-threat-detector"
      vpc_name: "my-vpc"
    test_env_vars:
      project: "PROJECT_NAME"
    # There can be only one DNS Threat Detector, so disable the test as the written test already covers it
    exclude_test: true
parameters:
  - name: "name"
    type: String
    description: |
      Name of the DnsThreatDetector resource.
    required: true
    immutable: true
    custom_flatten: "templates/terraform/custom_flatten/name_from_self_link.tmpl"
  - name: "location"
    type: String
    description: |
      The location of the DNS Threat Detector. The only supported value is `global`.
    url_param_only: true
    immutable: true
    default_value: "global"
properties:
  - name: "threatDetectorProvider"
    type: String
    api_name: "provider"
    description: |
      DNS Threat Detection provider. The only supported value is `INFOBLOX`.
    immutable: true
  - name: "excludedNetworks"
    type: Array
    description: |
      List of networks that are excluded from detection. Format: projects/{project}/global/networks/{name}.
    item_type:
      type: String
  - name: "createTime"
    type: Time
    description: |
      The timestamp when the resource was created.
      A timestamp in RFC3339 UTC "Zulu" format, with nanosecond resolution and up to nine fractional digits.
      Examples: "2014-10-02T15:01:23Z" and "2014-10-02T15:01:23.045123456Z"
    output: true
  - name: "updateTime"
    type: Time
    description: |
      The timestamp when the resource was updated.
      A timestamp in RFC3339 UTC "Zulu" format, with nanosecond resolution and up to nine fractional digits.
      Examples: "2014-10-02T15:01:23Z" and "2014-10-02T15:01:23.045123456Z".
    output: true
  - name: "labels"
    type: KeyValueLabels
    description: |
      Set of label tags associated with the DNS Threat Detector resource.
      An object containing a list of "key": value pairs. Example: { "name": "wrench", "mass": "1.3kg", "count": "3" }.
