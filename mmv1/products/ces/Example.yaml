# Copyright 2025 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---
name: Example
description: An example represents a sample conversation between the user and the agent(s).
base_url: projects/{{project}}/locations/{{location}}/apps/{{app}}/examples
update_mask: true
self_link: projects/{{project}}/locations/{{location}}/apps/{{app}}/examples/{{name}}
create_url: projects/{{project}}/locations/{{location}}/apps/{{app}}/examples?exampleId={{example_id}}
update_verb: PATCH
id_format: projects/{{project}}/locations/{{location}}/apps/{{app}}/examples/{{name}}
import_format:
  - projects/{{project}}/locations/{{location}}/apps/{{app}}/examples/{{name}}
examples:
  - name: "ces_example_basic"
    primary_resource_id: "my-example"
    vars:
      example_display_name: 'my-example'
      app_display_name: 'my-app'
      example_id: 'example-id'
      app_id: 'app-id'
      base_agent_id: 'base-agent-id'
      child_agent_id: 'child-agent-id'
      toolset_id: 'toolset-id'
autogen_status: RXhhbXBsZQ==
parameters:
  - name: location
    type: String
    description: Resource ID segment making up resource `name`, defining what region the parent app is in. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: app
    type: String
    description: Resource ID segment making up resource `name`, defining the app the example belongs to. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: exampleId
    type: String
    description: |-
      The ID to use for the example, which will become the final component of
      the example's resource name. In Terraform, this field is required.
    immutable: true
    url_param_only: true
    required: true
properties:
  - name: createTime
    type: String
    description: Timestamp when the example was created.
    output: true
  - name: description
    type: String
    description: Human-readable description of the example.
  - name: displayName
    type: String
    description: Display name of the example.
    required: true
  - name: entryAgent
    type: String
    description: |-
      The agent that initially handles the conversation. If not specified, the
      example represents a conversation that is handled by the root agent.
      Format: `projects/{project}/locations/{location}/apps/{app}/agents/{agent}`
  - name: etag
    type: Fingerprint
    description: |-
      Etag used to ensure the object hasn't changed during a read-modify-write
      operation. If the etag is empty, the update will overwrite any concurrent
      changes.
    output: true
  - name: invalid
    type: Boolean
    description: |-
      The example may become invalid if referencing resources are deleted.
      Invalid examples will not be used as few-shot examples.
    output: true
  - name: messages
    type: Array
    description: The collection of messages that make up the conversation.
    item_type:
      type: NestedObject
      properties:
        - name: chunks
          type: Array
          description: Content of the message as a series of chunks.
          item_type:
            type: NestedObject
            properties:
              - name: agentTransfer
                type: NestedObject
                description: |-
                  Represents an event indicating the transfer of a conversation to a different
                  agent.
                properties:
                  - name: displayName
                    type: String
                    description: Display name of the agent.
                    output: true
                  - name: targetAgent
                    type: String
                    description: |-
                      The agent to which the conversation is being transferred. The agent will
                      handle the conversation from this point forward.
                      Format: `projects/{project}/locations/{location}/apps/{app}/agents/{agent}`
                    required: true
              - name: image
                type: NestedObject
                description: Represents an image input or output in the conversation.
                properties:
                  - name: data
                    type: String
                    description: Raw bytes of the image.
                    required: true
                  - name: mimeType
                    type: String
                    description: |-
                      The IANA standard MIME type of the source data.
                      Supported image types includes:
                      * image/png
                      * image/jpeg
                      * image/webp
                    required: true
              - name: text
                type: String
                description: Text data.
              - name: toolCall
                type: NestedObject
                description: Request for the client or the agent to execute the specified tool.
                properties:
                  - name: args
                    type: String
                    description: The input parameters and values for the tool in JSON object format.
                    custom_flatten: 'templates/terraform/custom_flatten/json_schema.tmpl'
                    custom_expand: 'templates/terraform/custom_expand/json_schema.tmpl'
                    validation:
                      function: 'validation.StringIsJSON'
                  - name: displayName
                    type: String
                    description: Display name of the tool.
                    output: true
                  - name: id
                    type: String
                    description: |-
                      The unique identifier of the tool call. If populated, the client should
                      return the execution result with the matching ID in
                      ToolResponse.
                  - name: tool
                    type: String
                    description: |-
                      The name of the tool to execute.
                      Format: `projects/{project}/locations/{location}/apps/{app}/tools/{tool}`
                  - name: toolsetTool
                    type: NestedObject
                    description: A tool that is created from a toolset.
                    properties:
                      - name: toolset
                        type: String
                        description: |-
                          The resource name of the Toolset from which this tool is derived.
                          Format:
                          `projects/{project}/locations/{location}/apps/{app}/toolsets/{toolset}`
                        required: true
                      - name: toolId
                        description: |-
                          The tool ID to filter the tools to retrieve the schema for.
              - name: toolResponse
                type: NestedObject
                description: The execution result of a specific tool from the client or the agent.
                properties:
                  - name: displayName
                    type: String
                    description: Display name of the tool.
                    output: true
                  - name: id
                    type: String
                    description: The matching ID of the tool call the response is for.
                  - name: response
                    type: String
                    description: |-
                      The tool execution result in JSON object format.
                      Use "output" key to specify tool response and "error" key to specify
                      error details (if any). If "output" and "error" keys are not specified,
                      then whole "response" is treated as tool execution result.
                    required: true
                    custom_flatten: 'templates/terraform/custom_flatten/json_schema.tmpl'
                    custom_expand: 'templates/terraform/custom_expand/json_schema.tmpl'
                    validation:
                      function: 'validation.StringIsJSON'
                  - name: tool
                    type: String
                    description: |-
                      The name of the tool to execute.
                      Format: `projects/{project}/locations/{location}/apps/{app}/tools/{tool}`
                  - name: toolsetTool
                    type: NestedObject
                    description: A tool that is created from a toolset.
                    properties:
                      - name: toolset
                        type: String
                        description: |-
                          The resource name of the Toolset from which this tool is derived.
                          Format:
                          `projects/{project}/locations/{location}/apps/{app}/toolsets/{toolset}`
                        required: true
                      - name: toolId
                        description: |-
                          The tool ID to filter the tools to retrieve the schema for.
              - name: updatedVariables
                type: String
                description: |-
                  A struct represents variables that were updated in the conversation,
                  keyed by variable names.
                custom_flatten: 'templates/terraform/custom_flatten/json_schema.tmpl'
                custom_expand: 'templates/terraform/custom_expand/json_schema.tmpl'
                validation:
                  function: 'validation.StringIsJSON'
        - name: role
          type: String
          description: The role within the conversation, e.g., user, agent.
  - name: name
    type: String
    description: |-
      Identifier. The unique identifier of the example.
      Format:
      `projects/{project}/locations/{location}/apps/{app}/examples/{example}`
    output: true
    custom_flatten: 'templates/terraform/custom_flatten/name_from_self_link.tmpl'
  - name: updateTime
    type: String
    description: Timestamp when the example was last updated.
    output: true
