# Copyright 2024 Google Inc.
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

---
name: VpcFlowLogsConfigByOrganizationAndLocation
description: Vpc Flow Logs Config allows configure Flow Logs for organization.
min_version: 'beta'
base_url: organizations/{{organization}}/locations/{{location}}/vpcFlowLogsConfigs
immutable: true
self_link: organizations/{{organization}}/locations/{{location}}/vpcFlowLogsConfigs/{{}}
create_url: organizations/{{organization}}/locations/{{location}}/vpcFlowLogsConfigs?={{}}
id_format: organizations/{{organization}}/locations/{{location}}/vpcFlowLogsConfigs/{{}}
import_format:
  - organizations/{{organization}}/locations/{{location}}/vpcFlowLogsConfigs/{{}}
examples:
  - name: name_of_example_file
    primary_resource_id: example
    vars:
      resource_name: test-resource
autogen_async: true
async:
  operation:
    timeouts:
      insert_minutes: 20
      update_minutes: 20
      delete_minutes: 20
    base_url: '{{op_id}}'
  actions:
    - create
    - delete
    - update
  type: OpAsync
  result:
    resource_inside_response: true
  include_project: false
autogen_status: VnBjRmxvd0xvZ3NDb25maWdCeU9yZ2FuaXphdGlvbkFuZExvY2F0aW9u
parameters:
  - name: organization
    type: String
    description: Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: location
    type: String
    description: Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
    immutable: true
    url_param_only: true
    required: true
  - name: vpcFlowLogsConfigId
    type: String
    description: ID of the `VpcFlowLogsConfig`.
    immutable: true
    url_param_only: true
    required: true
properties:
  - name: targetResourceState
    type: String
    description: |-
      Describes the state of the configured target resource for diagnostic
      purposes.
      Possible values:
      TARGET_RESOURCE_STATE_UNSPECIFIED
      TARGET_RESOURCE_EXISTS
      TARGET_RESOURCE_DOES_NOT_EXIST
    output: true
  - name: subnet
    type: String
    description: |-
      Traffic will be logged from VMs within the subnetwork.
      Format: projects/{project_id}/regions/{region}/subnetworks/{name}
  - name: flowSampling
    type: Double
    description: |-
      The value of the field must be in (0, 1]. The sampling rate of VPC Flow
      Logs where 1.0 means all collected logs are reported.
      Setting the sampling rate to 0.0 is not allowed. If you want to disable VPC
      Flow Logs, use the state field instead.
      Default value is 1.0.
  - name: filterExpr
    type: String
    description: Export filter used to define which VPC Flow Logs should be logged.
  - name: network
    type: String
    description: |-
      Traffic will be logged from VMs, VPN tunnels and Interconnect Attachments
      within the network.
      Format: projects/{project_id}/global/networks/{name}
  - name: labels
    type: KeyValueLabels
    description: Resource labels to represent user-provided metadata.
  - name: createTime
    type: String
    description: The time the config was created.
    output: true
  - name: updateTime
    type: String
    description: The time the config was updated.
    output: true
  - name: crossProjectMetadata
    type: String
    description: |-
      Determines whether to include cross project annotations in the logs.
      This field is available only for organization configurations. If not
      specified in org configs will be set to CROSS_PROJECT_METADATA_ENABLED.
      Possible values:
      CROSS_PROJECT_METADATA_UNSPECIFIED
      CROSS_PROJECT_METADATA_ENABLED
      CROSS_PROJECT_METADATA_DISABLED
  - name: name
    type: String
    description: |-
      Identifier. Unique name of the configuration. The name can have one of the following
      forms:

      - For project-level configurations:
      `projects/{project_id}/locations/global/vpcFlowLogsConfigs/{vpc_flow_logs_config_id}`

      - For organization-level configurations:
      `organizations/{organization_id}/locations/global/vpcFlowLogsConfigs/{vpc_flow_logs_config_id}`
    output: true
  - name: state
    type: String
    description: |-
      The state of the VPC Flow Log configuration. Default value is ENABLED.
      When creating a new configuration, it must be enabled.
      Setting state=DISABLED will pause the log generation for this config.
      Possible values:
      STATE_UNSPECIFIED
      ENABLED
      DISABLED
  - name: interconnectAttachment
    type: String
    description: |-
      Traffic will be logged from the Interconnect Attachment.
      Format:
      projects/{project_id}/regions/{region}/interconnectAttachments/{name}
  - name: vpnTunnel
    type: String
    description: |-
      Traffic will be logged from the VPN Tunnel.
      Format: projects/{project_id}/regions/{region}/vpnTunnels/{name}
  - name: description
    type: String
    description: |-
      The user-supplied description of the VPC Flow Logs configuration.
      Maximum of 512 characters.
  - name: aggregationInterval
    type: String
    description: |-
      The aggregation interval for the logs. Default value is INTERVAL_5_SEC.
      Possible values:
      AGGREGATION_INTERVAL_UNSPECIFIED
      INTERVAL_5_SEC
      INTERVAL_30_SEC
      INTERVAL_1_MIN
      INTERVAL_5_MIN
      INTERVAL_10_MIN
      INTERVAL_15_MIN
  - name: metadata
    type: String
    description: |-
      Configures whether all, none or a subset of metadata fields should be
      added to the reported VPC flow logs.
      Default value is INCLUDE_ALL_METADATA.
      Possible values:
      METADATA_UNSPECIFIED
      INCLUDE_ALL_METADATA
      EXCLUDE_ALL_METADATA
      CUSTOM_METADATA
  - name: metadataFields
    type: Array
    description: |-
      Custom metadata fields to include in the reported VPC flow logs.
      Can only be specified if "metadata" was set to CUSTOM_METADATA.
    item_type:
      type: String
