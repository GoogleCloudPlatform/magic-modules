# Copyright 2023 Google Inc.
# Licensed under the Apache License, Version 2.0 (the License);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

--- !ruby/object:Api::Resource
name: 'Gateway'
base_url: 'projects/{{project}}/locations/{{location}}/gateways'
create_url: 'projects/{{project}}/locations/{{location}}/gateways?gatewayId={{gateway}}'
self_link: 'projects/{{project}}/locations/{{location}}/gateways/{{gateway}}'
update_verb: :PATCH
update_mask: true
description: |
  Gateway represents the configuration for a proxy, typically a load balancer. It captures the ip:port over which the services are exposed by the proxy, along with any policy configurations. Routes have reference to to Gateways to dictate how requests should be routed by this Gateway.
async: !ruby/object:Api::OpAsync
  operation: !ruby/object:Api::OpAsync::Operation
    path: 'name'
    base_url: '{{op_id}}'
    wait_ms: 1000
    timeouts: !ruby/object:Api::Timeouts
      insert_minutes: 30
      update_minutes: 30
      delete_minutes: 30
  result: !ruby/object:Api::OpAsync::Result
    path: 'response'
  status: !ruby/object:Api::OpAsync::Status
    path: 'done'
    complete: true
    allowed:
      - true
      - false
  error: !ruby/object:Api::OpAsync::Error
    path: 'error'
    message: 'message'
parameters:
  - !ruby/object:Api::Type::String
    name: 'gateway'
    required: true
    url_param_only: true
    description: |
      Name of the resource; provided by the client when the resource is created.
      The name must be 1-64 characters long, and match the regular expression [a-zA-Z][a-zA-Z0-9_-]* which means the first character must be a letter,
      and all following characters must be a dash, underscore, letter or digit.
  - !ruby/object:Api::Type::String
    name: 'location'
    required: true
    url_param_only: true
    description: The location of the gateway
properties:
  - !ruby/object:Api::Type::String
    name: 'name'
    description: |
          Required. Name of the Gateway resource. It matches pattern `projects/*/locations/*/gateways/`.
    required: true
  - !ruby/object:Api::Type::String
    name: 'description'
    description: |
          A human-readable description of the resource.
  - !ruby/object:Api::Type::KeyValuePairs
    name: 'labels'
    description: 'Set of label tags associated with the Gateway resource.'
  - !ruby/object:Api::Type::Time
    name: 'creationTime'
    description: |
          The time that this resource was created on the server.
    output: true
  - !ruby/object:Api::Type::Time
    name: 'updateTime'
    description: |
          The time that this resource was updated on the server.
    output: true
  - !ruby/object:Api::Type::String
    name: 'scope'
    description: |
          Scope determines how configuration across multiple Gateway instances are merged.
    required: true
  - !ruby/object:Api::Type::String
    name: 'serverTlsPolicy'
    description: |
          Optional. A fully-qualified ServerTLSPolicy URL reference.
  - !ruby/object:Api::Type::Enum
    name: 'type'
    description: |
          Immutable. The type of the customer managed gateway. Possible values: TYPE_UNSPECIFIED, OPEN_MESH, SECURE_WEB_GATEWAY'
    required: true
    values:
      - :TYPE_UNSPECIFIED
      - :OPEN_MESH
      - :SECURE_WEB_GATEWAY
  - !ruby/object:Api::Type::Array
    name: ports
    item_type: Api::Type::Integer
    description: |
          Required. One or more ports that the Gateway must receive traffic on.  
    required: true
    send_empty_value: true 

