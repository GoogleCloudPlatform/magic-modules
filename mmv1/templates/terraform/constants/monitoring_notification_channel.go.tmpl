
var sensitiveLabels = []string{"auth_token", "service_key", "password"}

func sensitiveLabelCustomizeDiff(_ context.Context, diff *schema.ResourceDiff, v interface{}) error {
	for _, sl := range sensitiveLabels {
		mapLabel := diff.Get("labels." + sl).(string)
		authLabel := diff.Get("sensitive_labels.0." + sl).(string)
		woLabel := diff.Get("sensitive_labels.0." + sl + "_wo").(string)
		count := 0

		if mapLabel != "" {
			count++
		}
		if authLabel != "" {
			count++
		}
		if woLabel != "" {
			count++
		}

		if count > 1 {
			return fmt.Errorf("Sensitive label [%s] cannot be set in multiple places. Use only one of `labels`, `sensitive_labels`, or `sensitive_labels_wo`.", sl)
		}
	}
	return nil
}