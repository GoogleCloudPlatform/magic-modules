
var sensitiveLabels = []string{"auth_token", "service_key", "password", "auth_token_wo", "service_key_wo", "password_wo"}

func sensitiveLabelCustomizeDiff(_ context.Context, diff *schema.ResourceDiff, v interface{}) error {
    for _, sp := range sensitiveLabels {
        mapLabel := diff.Get("labels." + sp).(string)
        authLabel := diff.Get("sensitive_labels.0." + sp).(string)
        if mapLabel != "" && authLabel != "" {
            return fmt.Errorf("Sensitive label [%s] cannot be set in both `labels` and the `sensitive_labels` block.", sp)
        }
    }

    return nil
}
