<%# We have to change the name of 'file' to 'filestore' for magic-modules generation reasons.-%>
import (
<% if version == "ga" -%>
  filestore "google.golang.org/api/file/v1beta1"
<% else -%>
  filestore "google.golang.org/api/file/v1"
<% end -%>
)

func resourceFilestoreInstanceMigrateState(
  v int, is *terraform.InstanceState, meta interface{}) (*terraform.InstanceState, error) {
  if is.Empty() {
    log.Println("[DEBUG] Empty InstanceState; nothing to migrate.")
    return is, nil
  }

  switch v {
  case 0:
    log.Println("[INFO] Found Filestore Instance State v0; migrating to v1")
    return migrateFilestoreInstanceStateV0toV1(is)
  default:
    return is, fmt.Errorf("Unexpected schema version: %d", v)
  }
}

func migrateFilestoreInstanceStateV0toV1(is *terraform.InstanceState) (*terraform.InstanceState, error) {
  log.Printf("[DEBUG] Attributes before migration: %#v", is.Attributes)
  is.Attributes["location"] = is.Attributes["zone"]
  log.Printf("[DEBUG] Attributes after migration: %#v", is.Attributes)
  return is, nil
}
