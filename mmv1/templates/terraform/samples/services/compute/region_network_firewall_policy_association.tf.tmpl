resource "google_compute_region_network_firewall_policy" "policy" {
  name = "{{index $.PrefixedVars "policy_name"}}"
  project = "{{index $.TestEnvVars "project_name"}}"
  description = "Sample global network firewall policy"
  region = "{{index $.TestEnvVars "region"}}"
}

resource "google_compute_network" "network" {
  name = "{{index $.PrefixedVars "network_name"}}"
  auto_create_subnetworks = false
}

resource "google_compute_region_network_firewall_policy_association" "{{$.PrimaryResourceId}}" {
  name = "{{index $.PrefixedVars "association_name"}}"
  project = "{{index $.TestEnvVars "project_name"}}"
  attachment_target = google_compute_network.network.id
  firewall_policy =  google_compute_region_network_firewall_policy.policy.id
  region = "{{index $.TestEnvVars "region"}}"
}