resource "google_cloud_run_v2_service" "{{$.PrimaryResourceId}}" {
  name     = "{{index $.PrefixedVars "cloud_run_service_name"}}"
  description = "description creating"
  location = "us-central1"
  annotations = {
    generated-by = "magic-modules"
  }
  ingress = "INGRESS_TRAFFIC_ALL"
  labels = {
    label-1 = "value-1"
  }
  client = "client-1"
  client_version = "client-version-1"
  scaling {
    min_instance_count = 1
    max_instance_count = 3
  }
  template {
    labels = {
      label-1 = "value-1"
    }
    timeout = "300s"
    service_account = google_service_account.service_account.email
    execution_environment = "EXECUTION_ENVIRONMENT_GEN2"
    annotations = {
      generated-by = "magic-modules"
    }
    containers {
      name = "container-1"
      image = "us-docker.pkg.dev/cloudrun/container/hello"
      env {
        name = "SOURCE"
        value = "remote"
      }
      env {
        name = "TARGET"
        value = "home"
      }
      ports {
        name = "h2c"
        container_port = 8080
      }
      resources {
        cpu_idle = true
        startup_cpu_boost = true
        limits = {
          cpu = "4"
          memory = "2Gi"
        }
      }
    }
    session_affinity = false
  }
}

resource "google_service_account" "service_account" {
  account_id   = "{{index $.PrefixedVars "service_account_id"}}"
  display_name = "Test Service Account"
}