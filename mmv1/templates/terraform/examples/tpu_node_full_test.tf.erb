<%#-
  WARNING: cidr_block must not overlap with other existing TPU blocks
  Make sure if you change this value that it does not overlap with the
  autogenerated examples.
-%>

resource "google_tpu_node" "<%= ctx[:primary_resource_id] %>" {
  name = "<%= ctx[:vars]["node_name"] %>"
  zone = "us-central1-b"

  accelerator_type = "v3-8"

  tensorflow_version = "2.10.0"

  description = "Terraform Google Provider test TPU"
  use_service_networking = true

  network = data.google_compute_network.network.id

  labels = {
    foo = "bar"
  }

  scheduling_config {
    preemptible = true
  }
}

data "google_compute_network" "network" {
  name = "<%= ctx[:vars]['network_name'] %>"
}
