resource "google_scc_organization_event_threat_detection_custom_module" "<%= ctx[:primary_resource_id] %>" {
  organization = "<%= ctx[:test_env_vars]['org_id'] %>"
  <% if ctx[:vars].key?('location') && !ctx[:vars]['location'].empty? %>location = "<%= ctx[:vars]['location'] %>"<% else %>location = "global"<% end %>
  display_name = "<%= ctx[:vars]['display_name'] %>"
  enablement_state = "ENABLED"
  type = "<%= ctx[:vars]['type'] %>"
  description = "My Event Threat Detection Custom Module"
  config = jsonencode({
    "metadata": {
      "severity": "LOW",
      "description": "Flagged by Forcepoint as malicious",
      "recommendation": "Contact the owner of the relevant project."
    },
    "ips": [
      "192.0.2.1",
      "192.0.2.0/24"
    ]
  })
}
