resource "google_service_account_iam_binding" "act_as_permission" {
  service_account_id = "projects/{{index $.TestEnvVars "project_id"}}/serviceAccounts/{{index $.TestEnvVars "service_account"}}"
  role               = "roles/iam.serviceAccountUser"
  members = [
    "user:example@example.com",
  ]
}

resource "google_colab_runtime_template" "my_template" {
  name = "{{index $.Vars "runtime_name"}}"
  display_name = "Runtime template basic"
  location = "us-central1"

  machine_spec {
    machine_type     = "e2-standard-4"
  }

  network_spec {
    enable_internet_access = true
  }
}

resource "google_colab_runtime" "{{$.PrimaryResourceId}}" {
  name = "{{index $.Vars "runtime_name"}}"
  display_name = "Runtime template basic"
  location = "us-central1"

  runtime_user = "example@example.com"

  notebook_runtime_template_ref {
    notebook_runtime_template = google_colab_runtime_template.my_template.id
  }
}
