resource "google_storage_bucket" "bucket" {
  name                        = "{{index $.Vars "bucket_name"}}"
  location                    = "US"
}

resource "google_storage_bucket_iam_binding" "binding" {
  bucket = google_storage_bucket.bucket.name
  role = "roles/storage.admin"
  members = [
    "allUsers",
  ]
  depends_on = [ google_storage_bucket.bucket ]
}

resource "time_sleep" "wait_7200_seconds" {
  depends_on = [google_storage_bucket.bucket]
  destroy_duration = "7200s"
}

resource "google_storage_anywhere_cache" "cache" {
    bucket = google_storage_bucket.bucket.name
    zone = "us-central1-f"
    depends_on = [ google_storage_bucket_iam_binding.binding ]
}
