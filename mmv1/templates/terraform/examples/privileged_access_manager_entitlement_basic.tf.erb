resource "google_privileged_access_manager_entitlement" "<%= ctx[:primary_resource_id] %>" {
    provider =  google-beta
    entitlement_id = "<%= ctx[:vars]['entitlement_id'] %>"
    location = "us-central1-a"
    max_request_duration = "43200s"
    parent = "projects/<%= ctx[:test_env_vars]['project'] %>"
    requester_justification_config {    
        unstructured{}
    }
    eligible_users {
        principals = ["serviceAccount:test2102@itsvarsharma-pam-testing.iam.gserviceaccount.com"]
    }
    privileged_access{
        gcp_iam_access{
            role_bindings{
                role = "roles/storage.admin"
            }
            resource = "//cloudresourcemanager.googleapis.com/projects/<%= ctx[:test_env_vars]['project'] %>"
            resource_type = "cloudresourcemanager.googleapis.com/Project"
        }
    }
    additional_notification_targets {
    admin_email_recipients     = []
    requester_email_recipients = []
    }
    approval_workflow {
    manual_approvals {
      require_approver_justification = true
      steps {
        approvals_needed          = 1
        approver_email_recipients = []
        approvers {
          principals = ["user:itsvarsharma@google.com"]
        }
      }
    }
  }
}
