resource "google_workbench_instance" "<%= ctx[:primary_resource_id] %>" {
  name = "<%= ctx[:vars]['instance_name'] %>"
  location = "us-central1-a"

  gce_setup {
    machine_type = "e2-standard-4"

    service_accounts {
      email = "<%= ctx[:test_env_vars]["service_account"] %>"
    }

    shielded_instance_config {
      enable_secure_boot = true
      enable_vtpm = true
      enable_integrity_monitoring = true
    }

    network_interfaces {
    }

    metadata = {
      terraform = "true"
    }

  }

  instance_owners  = [ "<%= ctx[:test_env_vars]["service_account"] %>"]

  labels = {
    k = "val"
  }

}
