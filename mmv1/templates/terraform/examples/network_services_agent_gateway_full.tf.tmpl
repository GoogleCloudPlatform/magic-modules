resource "google_network_services_agent_gateway" "{{$.PrimaryResourceId}}" {
  name     = "{{index $.Vars "name"}}"
  location = "us-central1"
  description = "A full configuration for Agent Gateway"
  labels = {
    env = "test"
    tier = "gold"
  }

  protocols = ["MCP"]
  google_managed {
    governed_access_path = "AGENT_TO_ANYWHERE"
  }

  registries = [
    "//agentregistry.googleapis.com/projects/{{index $.TestEnvVars "project"}}/locations/us-central1"
  ]

  network_config {
    egress {
      network_attachment = "projects/{{index $.TestEnvVars "project"}}/regions/us-central1/networkAttachments/my-network-attachment"
    }
  }
}
