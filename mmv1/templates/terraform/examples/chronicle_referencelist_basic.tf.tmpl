resource "google_chronicle_data_access_scope" "test_scope" {
  location = "us"
  instance = "{{index $.TestEnvVars "chronicle_id"}}"
  data_access_scope_id = "{{index $.Vars "data_access_scope_id"}}"
  description = "test scope description"
  allowed_data_access_labels {
    log_type = "GCP_CLOUDAUDIT"
  }
}

resource "google_chronicle_reference_list" "{{$.PrimaryResourceId}}" {
  location = "us"
  instance = "{{index $.TestEnvVars "chronicle_id"}}"
  reference_list_id = "{{index $.Vars "reference_list_id"}}"
  description = "referencelist-description"
  entries {
    value = "referencelist-entry-value"
  }
  syntax_type = "REFERENCE_LIST_SYNTAX_TYPE_PLAIN_TEXT_STRING"
  scope_info {
    reference_list_scope {
      scope_names = [
        google_chronicle_data_access_scope.test_scope.name
      ]
    }
  }
}
