# [START dns_policy_multiproject]
resource "google_dns_policy" "<%= ctx[:primary_resource_id] %>" {
  name                      = "<%= ctx[:vars]['policy_name'] %>"
  enable_inbound_forwarding = true

  enable_logging = true

  networks {
    network_url = google_compute_network.network-1_project-1.id
  }
  networks {
    network_url = google_compute_network.network-2_project-1.id
  }
  networks {
    network_url = google_compute_network.network-1_project-2.id
  }
  networks {
    network_url = google_compute_network.network-2_project-2.id
  }
}

resource "google_compute_network" "network-1_project-1" {
  name                    = "<%= ctx[:vars]['network_1_name'] %>"
  project                 = "<%= ctx[:vars]['project_1_name'] %>"
  auto_create_subnetworks = false
}

resource "google_compute_network" "network-2_project-1" {
  name                    = "<%= ctx[:vars]['network_2_name'] %>"
  project                 = "<%= ctx[:vars]['project_1_name'] %>"
  auto_create_subnetworks = false
}

resource "google_compute_network" "network-1_project-2" {
  name                    = "<%= ctx[:vars]['network_1_name'] %>"
  project                 = "<%= ctx[:vars]['project_2_name'] %>"
  auto_create_subnetworks = false
}

resource "google_compute_network" "network-2_project-2" {
  name                    = "<%= ctx[:vars]['network_2_name'] %>"
  project                 = "<%= ctx[:vars]['project_2_name'] %>"
  auto_create_subnetworks = false
}
# [END dns_policy_multiproject]