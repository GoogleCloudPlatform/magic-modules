resource "google_dataplex_datascan" "<%= ctx[:primary_resource_id] %>" {
  location     = "us-central1"
  data_scan_id = "<%= ctx[:vars]['datascan_name'] %>"

  data {
    resource = "//bigquery.googleapis.com/projects/bigquery-public-data/datasets/samples/tables/shakespeare"
  }

  execution_spec {
    trigger {
      on_demand {}
    }
  }

  data_quality_spec {
    rules {
      dimension = "VALIDITY"
      name = "rule1"
      description = "rule 1 for validity dimension"
      table_condition_expectation {
        sql_expression = "COUNT(*) > 0"
      }
    }
  }

  project = "<%= ctx[:test_env_vars]['project_name'] %>"
}
