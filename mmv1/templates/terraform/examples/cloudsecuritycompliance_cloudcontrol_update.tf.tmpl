resource "google_cloud_security_compliance_cloud_control" "example" {
  name              = "organizations/%{org_id}/locations/global/cloudControls/tf-test-%{random_suffix}"
  organization      = "%{org_id}"
  location          = "global"
  cloud_control_id  = "tf-test-%{random_suffix}"

  
  display_name      = "Updated CloudControl Name"
  description       = "An updated description for the cloud control"
  categories        = ["CC_CATEGORY_INFRASTRUCTURE"]
  severity          = "CRITICAL"
  finding_category  = "UPDATED_SECURITY_POLICY"
  remediation_steps = "Updated remediation steps with more detailed instructions for security configuration."
  
  supported_cloud_providers        = ["GCP", "AWS"]
  supported_target_resource_types = ["TARGET_RESOURCE_CRM_TYPE_ORG"]
  
  rules {
    description         = "Updated rule: Ensure compute instances have secure boot and integrity monitoring enabled"
    rule_action_types   = ["RULE_ACTION_TYPE_DETECTIVE"]
    
    cel_expression {
      expression = "resource.data.shieldedInstanceConfig.enableSecureBoot == true && resource.data.shieldedInstanceConfig.enableIntegrityMonitoring == true"
      resource_types_values {
        values = ["compute.googleapis.com/Instance"]
      }
    }
  }
  
  parameter_spec {
    name         = "location"
    display_name = "Updated Resource Location"
    description  = "Updated description for the location parameter"
    value_type   = "STRING"
    is_required  = true
    
    default_value {
      string_value = "us-west1"
    }
    
    validation {
      regexp_pattern {
        pattern = "^[a-z]+-[a-z]+[0-9]$"
      }
    }
  }
}