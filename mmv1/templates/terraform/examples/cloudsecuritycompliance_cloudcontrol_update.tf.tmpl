resource "google_cloud_security_compliance_cloudcontrol" "{{$.PrimaryResourceId}}" {
  organization      = "{{index $.TestEnvVars "org_id"}}"
  location          = "global"
  cloud_control_id  = "{{index $.Vars "cloudcontrol_name"}}"
  
  display_name      = "Updated CloudControl Name"
  description       = "An updated description for the cloud control"
  categories        = ["SECURITY", "COMPLIANCE"]
  severity          = "CRITICAL"
  finding_category  = "UPDATED_SECURITY_POLICY"
  remediation_steps = "Updated remediation steps with more detailed instructions for security configuration."
  
  supported_cloud_providers        = ["GCP", "AWS"]
  supported_target_resource_types = ["compute.googleapis.com/Instance", "storage.googleapis.com/Bucket"]
  
  rules {
    description         = "Updated rule: Ensure compute instances have secure boot and integrity monitoring enabled"
    rule_action_types   = ["DETECTIVE", "PREVENTIVE"]
    
    cel_expression {
      expression = "resource.data.shieldedInstanceConfig.enableSecureBoot == true && resource.data.shieldedInstanceConfig.enableIntegrityMonitoring == true"
      resource_types_values {
        values = ["compute.googleapis.com/Instance"]
      }
    }
  }
  
  parameter_spec {
    name         = "location"
    display_name = "Updated Resource Location"
    description  = "Updated description for the location parameter"
    value_type   = "STRING"
    is_required  = true
    
    default_value {
      string_value = "us-west1"
    }
    
    validation {
      regexp_pattern {
        pattern = "^[a-z]+-[a-z]+[0-9]$"
      }
    }
  }
  
  parameter_spec {
    name         = "enable_monitoring"
    display_name = "Enable Monitoring"
    description  = "Whether to enable monitoring for the resource"
    value_type   = "BOOLEAN"
    is_required  = false
    
    default_value {
      bool_value = true
    }
  }
}