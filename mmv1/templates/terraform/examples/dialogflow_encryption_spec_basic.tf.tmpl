resource "google_project" "agent_project" {
  project_id = "{{index $.Vars "project_id"}}"
  name = "{{index $.Vars "project_id"}}"
  org_id = "{{index $.Vars "org_id"}}"
  deletion_policy = "DELETE"
}

resource "google_project_service" "agent_project" {
  project = google_project.agent_project.project_id
  service = "dialogflow.googleapis.com"
  disable_dependent_services = false
}

resource "google_service_account" "dialogflow_service_account" {
  account_id = "{{index $.Vars "account_id"}}"
}

resource "google_dialogflow_encryption_spec" "{{$.PrimaryResourceId}}" {
  project  = google_project.agent_project.project_id
  location = "europe-west1"
  encryption_spec {
    kms_key = "{{index $.Vars "kms_key_name"}}"
  }
}
