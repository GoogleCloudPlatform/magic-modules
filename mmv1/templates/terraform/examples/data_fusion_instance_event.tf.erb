resource "google_data_fusion_instance" "<%= ctx[:primary_resource_id] %>" {
  name    = "<%= ctx[:vars]["instance_name"] %>"
  region  = "us-central1"
  type    = "BASIC"
  version = "6.7.0"

  event_publish_config {
    enabled = true
    topic   = google_pubsub_topic.<%= ctx[:primary_resource_id] %>.id
  }
}

resource "google_pubsub_topic" "<%= ctx[:primary_resource_id] %>" {
  name = "<%= ctx[:vars]["instance_name"] %>"
}