resource "google_compute_network" "default" {
  name = "{{index $.Vars "network_name"}}"
}

resource "google_compute_region_backend_service" "{{$.PrimaryResourceId}}" {
  region                          = "us-central1"
  name                            = "{{index $.Vars "region_backend_service_name"}}"
  protocol                        = "UDP"
  load_balancing_scheme           = "EXTERNAL"
  network                         = google_compute_network.default.id
  ha_policy  {
    fast_ip_move                  = "GARP_RA"
  }
  // Must explicitly disable connection draining to override default value.
  connection_draining_timeout_sec = 0
}

