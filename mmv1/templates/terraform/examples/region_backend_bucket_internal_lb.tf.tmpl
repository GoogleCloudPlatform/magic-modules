resource "google_compute_region_backend_bucket" "{{$.PrimaryResourceId}}" {
  name                  = "{{index $.Vars "backend_bucket_name"}}"
  region                = "us-central1"
  bucket_name           = google_storage_bucket.{{$.PrimaryResourceId}}.name
  load_balancing_scheme = "INTERNAL_MANAGED"
  description           = "Regional internal backend bucket for static content"
}

resource "google_storage_bucket" "{{$.PrimaryResourceId}}" {
  name                        = "{{index $.Vars "bucket_name"}}"
  location                    = "US-CENTRAL1"
  force_destroy               = true
  uniform_bucket_level_access = true
  
  website {
    main_page_suffix = "index.html"
    not_found_page   = "404.html"
  }
}

resource "google_storage_bucket_object" "index" {
  name    = "index.html"
  bucket  = google_storage_bucket.{{$.PrimaryResourceId}}.name
  content = "<html><body><h1>Regional Internal LB Backend Bucket</h1></body></html>"
}