### Snippet #2: gcloud with explicit config
#
# this is equivalent to what you get when you run the explicit example from the
# docs:
#
#     $ gcloud compute instance-templates create example-template-custom \
#         --machine-type e2-standard-4 \
#         --image-family debian-9 \
#         --image-project debian-cloud \
#         --boot-disk-size 250GB
#
# As before, we must specify the network tier and SA scopes in order to create
# an equivalent template

# [START compute_instance_template_basic]
resource "google_compute_instance_template" "<%= ctx[:primary_resource_id] %>" {
  name         = "<%= ctx[:vars]['example_template_custom'] %>"
  machine_type = "e2-standard-4"

  disk {
    source_image = "debian-cloud/debian-9"
    disk_size_gb = 250
  }

  network_interface {
    network = "default"

    # secret default
    access_config {
      network_tier = "PREMIUM"
    }
  }

  # secret default
  service_account {
    scopes = [
      "https://www.googleapis.com/auth/devstorage.read_only",
      "https://www.googleapis.com/auth/logging.write",
      "https://www.googleapis.com/auth/monitoring.write",
      "https://www.googleapis.com/auth/pubsub",
      "https://www.googleapis.com/auth/service.management.readonly",
      "https://www.googleapis.com/auth/servicecontrol",
      "https://www.googleapis.com/auth/trace.append",
    ]
  }
}
# [END compute_instance_template_basic]
