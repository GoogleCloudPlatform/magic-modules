<% gcp_organization_id = "#{external_attribute('gcp_organization_id', doc_generation)}" -%>
<% folder_exclusion = grab_attributes['folder_exclusion'] -%>
# Getting folder exclusions is complicated due to the name being generated by the server.
# This can be drastically simplified if you have the name when writing the test
describe.one do
  google_resourcemanager_folders(parent: <%= doc_generation ? "'organizations/12345'" : "\"organizations/\#{gcp_organization_id}\"" -%>).names.each do |name|
    # name on a folder is in the form `folders/12345`
    describe google_logging_folder_exclusions(folder: name.split('/')[1]) do
      its('names'){ should include <%= doc_generation ? "'#{folder_exclusion['name']}'" : "folder_exclusion['name']" -%> }
      its('descriptions'){ should include <%= doc_generation ? "'#{folder_exclusion['description']}'" : "folder_exclusion['description']" -%> }
      its('filters'){ should include <%= doc_generation ? "'#{folder_exclusion['filter']}'" : "folder_exclusion['filter']" -%> }
    end
  end
end