---
<%= compile 'templates/ansible/autogen_notice.erb' -%>
<% if example.dependencies -%>
#---------------------------------------------------------
# Pre-test setup
<% object.dependencies.each do |depend| -%>
<%= lines(dependent.build_test('present', false)) -%>
<% end # object.dependencies.each -%>
<% end # if example.dependencies -%>
#----------------------------------------------------------
<% resource_name = Google::StringUtils.uncombine(object.name).downcase -%>
<%= lines(example.task.build_test('present', false)) -%>
  register: result
- name: assert changed is true
  assert:
    that:
      - result.changed == true
      - "result.kind == <%= quote_string(object.kind) -%>"
# ----------------------------------------------------------------------------
<%= lines(example.task.build_test('present', true)) -%>
  register: result
- name: assert changed is false
  assert:
    that:
      - result.changed == false
      - "result.kind == <%= quote_string(object.kind) -%>"
#----------------------------------------------------------
<%= lines(example.task.build_test('absent', false)) -%>
  register: result
- name: assert changed is true
  assert:
    that:
      - result.changed == true
      - result.has_key('kind') == False
# ----------------------------------------------------------------------------
<%= lines(example.task.build_test('absent', true)) -%>
  register: result
- name: assert changed is false
  assert:
    that:
      - result.changed == false
      - result.has_key('kind') == False
<% if example.dependencies -%>
#---------------------------------------------------------
# Post-test teardown
<% object.dependencies.each do |depend| -%>
<%= lines(dependent.build_test('absent', false)) -%>
<% end # object.dependencies.each -%>
<% end # if example.dependencies -%>
