resource "google_project_service" "cloud-iot-apis" {
  service = "cloudiot.googleapis.com"

  disable_dependent_services = true
}

resource "google_cloudiot_registry" "<%= ctx[:primary_resource_id] %>" {
  name     = "<%= ctx[:vars]['cloudiot_registry_name'] %>"

  depends_on = [
    google_project_service.cloud-iot-apis
  ]
}
