<%
    direct_children = Set.new
    properties.sort_by{|p| [p.order, p.name]}.each do |prop|
      prop.azure_sdk_references.select{|ref| sdk_type_defs.has_key?(ref)}.each do |child_api_path|
        if api_path == ""
          sub_paths = child_api_path.split("/")
          direct_children << child_api_path if sub_paths.length == 1
        elsif child_api_path.start_with?(api_path + "/")
          sub_paths = child_api_path[api_path.length..-1].split("/")
        end
        if !sub_paths.nil? && sub_paths.length > 1 && sub_paths[0] == ""
          sub_api_path = api_path + "/" + sub_paths[1]
          direct_children << sub_api_path if sub_paths.length > 2
          direct_children << child_api_path if sub_paths.length == 2
        end
      end
    end

    direct_children.each do |child_api_path|
      matched_properties = get_properties_matching_sdk_reference(properties, child_api_path, object)
-%>
<%=   lines(build_schema_assignment(input_statement, output, nil, child_api_path, sdk_type_defs, resource_name, flatten_queue, properties, object)) if matched_properties.empty? -%>
<%    matched_properties.each do |property| -%>
<%=     lines(build_schema_assignment(input_statement, output, property, child_api_path, sdk_type_defs, resource_name, flatten_queue, properties, object)) -%>
<%    end -%>
<%  end -%>