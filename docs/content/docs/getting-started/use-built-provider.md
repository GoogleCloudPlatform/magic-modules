---
title: Use built provider
weight: 40
---

# Use built provider locally

{{< hint info >}}
**Note:** If you want to test changes you've made in Magic Modules, you need to first [generate](/magic-modules/docs/getting-started/generate-providers/) the provider you want to test.
{{< /hint >}}

Sometimes, for example for manual testing, you may want to build the provider from source and use it with `terraform`.

## Setup

Choose your architecture below.

{{< details "Mac ARM64" >}}
```bash
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/darwin_arm64
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/darwin_arm64
ln -s $GOPATH/bin/terraform-provider-google ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/darwin_arm64/terraform-provider-google_v9.0.0
ln -s $GOPATH/bin/terraform-provider-google-beta ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/darwin_arm64/terraform-provider-google-beta_v9.0.0
```
{{< /details >}}


{{< details "Mac AMD64" >}}
```bash
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/darwin_amd64
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/darwin_amd64
ln -s $GOPATH/bin/terraform-provider-google ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/darwin_amd64/terraform-provider-google_v9.0.0
ln -s $GOPATH/bin/terraform-provider-google-beta ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/darwin_amd64/terraform-provider-google-beta_v9.0.0
```
{{< /details >}}

{{< details "Linux AMD64" >}}
```bash
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/linux_amd64
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/linux_amd64
ln -s $GOPATH/bin/terraform-provider-google ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/linux_amd64/terraform-provider-google_v9.0.0
ln -s $GOPATH/bin/terraform-provider-google-beta ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/linux_amd64/terraform-provider-google-beta_v9.0.0
```
{{< /details >}}

{{< details "Other: substitute your architecture" >}}
```bash
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/myarch_amd64
mkdir -p ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/myarch_amd64
ln -s $GOPATH/bin/terraform-provider-google ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google/9.0.0/myarch_amd64/terraform-provider-google_v9.0.0
ln -s $GOPATH/bin/terraform-provider-google-beta ~/.terraform.d/plugins/registry.terraform.io/hashicorp/google-beta/9.0.0/myarch_amd64/terraform-provider-google-beta_v9.0.0
```
{{< /details >}}

Once this setup is complete, terraform will automatically use the binaries generated by the `make build` commands in the `terraform-provider-google` and `terraform-provider-google-beta` repositories instead of downloading the latest versions. 

## Build provider

```bash
# ga provider
cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
make build

# beta provider
cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
make build
```

## Cleanup

To stop using the local provider binary, you can run:

```bash
rm -rf ~/.terraform.d/plugins/registry.terraform.io/hashicorp/
```

## Download production providers

When in this mode, Terraform will be unable to pull the `google` and `google-beta` providers from the registry using `terraform init`, even if a version constraint requires them. However, providers downloaded to the discovery directory may be used by `init`. To download providers to the discovery directory, run `terraform providers mirror ~/.terraform.d/plugins` from your configuration's directory prior to running `terraform init`.

## More information

For more information, check out Hashicorp's documentation on the [0.13+ filesystem layout](https://www.terraform.io/upgrade-guides/0-13.html#new-filesystem-layout-for-local-copies-of-providers).

If multiple versions are available in a plugin directory (for example after `terraform providers mirror` is used), Terraform will pick the most up-to-date provider version within version constraints. As such, we recommend using a version that is several major versions ahead for your local copy of the provider, such as `9.0.0`.
