---
steps:
  # The GCB / GH integration uses a shallow clone of the repo. We need to convert
  # that to a full clone in order to work with it properly.
  # https://cloud.google.com/source-repositories/docs/integrating-with-cloud-build#unshallowing_clones
  - name: "gcr.io/cloud-builders/git"
    args:
      - fetch
      - --unshallow

logsBucket: 'gs://cloudbuild-membership-checker-logs'
availableSecrets:
  secretManager:
    - versionName: projects/673497134629/secrets/github-magician-token-generate-diffs-magic-modules/versions/latest
      env: GITHUB_TOKEN_MAGIC_MODULES
    - versionName: projects/673497134629/secrets/ci-trigger-downstream-generation-and-test/versions/latest
      env: DOWNSTREAM_GENERATION_AND_TEST_TRIGGER
