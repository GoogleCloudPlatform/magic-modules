<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Guidance on making a breaking changes"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/develop/breaking-changes/make-a-breaking-change/"><meta property="og:site_name" content="Magic Modules"><meta property="og:title" content="Make a breaking change"><meta property="og:description" content="Guidance on making a breaking changes"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="develop"><meta property="article:modified_time" content="2024-11-14T11:32:24-05:00"><title>Make a breaking change | Magic Modules</title>
<link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png><link rel=canonical href=https://googlecloudplatform.github.io/magic-modules/develop/breaking-changes/make-a-breaking-change/><link rel=stylesheet href=/magic-modules/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/magic-modules/fuse.min.js></script><script defer src=/magic-modules/en.search.min.f686760f276f367e30ff2dd94f5c15e99e2bb485c0ba5435281661161cc9418e.js integrity="sha256-9oZ2DydvNn4w/y3ZT1wV6Z4rtIXAulQ1KBZhFhzJQY4=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><a href=/magic-modules/contribution-process/>Contribution process</a></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/set-up-dev-environment/>Set up your development environment</a></li><li><a href=/magic-modules/develop/resource/>Add or modify a resource</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/update-dependencies/>Update dependencies</a></li><li><a href=/magic-modules/develop/diffs/>Fix diffs</a></li><li><a href=/magic-modules/develop/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/develop/field-reference/>MMv1 field reference</a></li><li><a href=/magic-modules/develop/resource-reference/>MMv1 resource reference</a></li><li><input type=checkbox id=section-388be1d03669075d184a63bd2902c124 class=toggle>
<label for=section-388be1d03669075d184a63bd2902c124 class="flex justify-between"><a role=button>Test</a></label><ul><li><a href=/magic-modules/develop/test/test/>Add resource tests</a></li><li><a href=/magic-modules/develop/test/run-tests/>Run tests</a></li></ul></li><li><input type=checkbox id=section-c414d1ebdbeb6957a666f9e9dfd1a53a class=toggle checked>
<label for=section-c414d1ebdbeb6957a666f9e9dfd1a53a class="flex justify-between"><a role=button>Breaking changes</a></label><ul><li><a href=/magic-modules/develop/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/develop/breaking-changes/make-a-breaking-change/ class=active>Make a breaking change</a></li></ul></li><li><a href=/magic-modules/develop/handwritten-docs-style-guide/>Handwritten docs style guide</a></li><li><a href=/magic-modules/develop/client-side-fields/>Client-side fields</a></li></ul></li><li><span>Best practices</span><ul><li><a href=/magic-modules/best-practices/immutable-fields/>Immutable fields</a></li><li><a href=/magic-modules/best-practices/deletion-behaviors/>Deletion behaviors</a></li><li><a href=/magic-modules/best-practices/labels-and-annotations/>Labels and annotations</a></li></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li><li><a href=/magic-modules/contribute/review-pr/>Review a pull request</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=/magic-modules/reference/ruby-go-changes/>Ruby to Go Migration</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Make a breaking change</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#in-minor-releases>In minor releases</a></li><li><a href=#in-the-600-major-release>In the 6.0.0 major release</a><ul><li><a href=#make-the-main-branch-forwards-compatible-with-the-major-release>Make the <code>main</code> branch forwards-compatible with the major release</a></li><li><a href=#add-deprecations-and-warnings-to-the-main-branch-of-magic-modules>Add deprecations and warnings to the <code>main</code> branch of <code>magic-modules</code></a></li><li><a href=#make-the-change-on-feature-branch-major-release-600>Make the change on <code>FEATURE-BRANCH-major-release-6.0.0</code></a></li></ul></li><li><a href=#whats-next>What&rsquo;s next?</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=make-a-breaking-change>Make a breaking change
<a class=anchor href=#make-a-breaking-change>#</a></h1><p>A &ldquo;breaking change&rdquo; is any change that requires an end user to modify any
previously-valid configuration after a provider upgrade. For more information,
see <a href=https://googlecloudplatform.github.io/magic-modules/develop/breaking-changes/>Types of breaking changes</a>.</p><p>The <code>google</code> and <code>google-beta</code> providers are both considered &ldquo;stable surfaces&rdquo;
for the purpose of releases, which means that neither provider allows breaking
changes except during major releases, which are typically yearly.</p><p>Terraform users rely on the stability of Terraform providers (including the
Google Cloud provider and other major providers.) Even as part of a major
release, breaking changes that are overly broad and/or have little benefit to
users can cause deeply negative reactions and significantly delay customers
upgrading to the new major version.</p><p>Breaking changes may cause significant churn for users by forcing them to
update their configurations. It also causes churn in tooling built on top of
the providers, such as:</p><ul><li>Terraform modules that use <code>google</code> or <code>google-beta</code> resources</li><li>Policy tools like <a href=https://cloud.google.com/docs/terraform/policy-validation/quickstart><code>gcloud terraform vet</code></a><ul><li>There may also be churn in customer policies</li></ul></li><li><a href=https://cloud.google.com/config-connector/docs/overview>Config Connector</a></li><li><a href=https://www.pulumi.com/registry/packages/gcp/>Pulumi GCP Classic</a></li></ul><p>This page covers the general process to make a breaking change. It does not
include exact, comprehensive details on how to make every potential breaking
change. Breaking changes are complicated; the exact process and implementation
may vary drastically depending on the implementation of the impacted resource
or field and the change being made.</p><h2 id=in-minor-releases>In minor releases
<a class=anchor href=#in-minor-releases>#</a></h2><p>If a breaking change fixes a bug that impacts <strong>all configurations</strong> that
include a field or resource, it is generally allowed in a minor release. For
example:</p><ul><li>Removing update support from a field if that field is not actually updatable
in the API.</li><li>Marking a field required if omitting the field always causes an API error.</li></ul><p>The following types of changes can be made if the default behavior stays the
same and new behavior can be enabled with a flag:</p><ul><li>Major resource-level or field-level behavioural changes</li></ul><h2 id=in-the-600-major-release>In the 6.0.0 major release
<a class=anchor href=#in-the-600-major-release>#</a></h2><p>The general process for contributing a breaking change to the
<code>6.0.0</code> major release is:</p><ol><li>Make the <code>main</code> branch forwards-compatible with the major release</li><li>Add deprecations and warnings to the <code>main</code> branch of <code>magic-modules</code></li><li>Add upgrade guide entries to the <code>FEATURE-BRANCH-major-release-6.0.0</code> branch of <code>magic-modules</code></li><li>Make the breaking change on <code>FEATURE-BRANCH-major-release-6.0.0</code></li></ol><p>These are covered in more detail in the following sections. The upgrade guide
and the actual breaking change will be merged only after both are completed.</p><h3 id=make-the-main-branch-forwards-compatible-with-the-major-release>Make the <code>main</code> branch forwards-compatible with the major release
<a class=anchor href=#make-the-main-branch-forwards-compatible-with-the-major-release>#</a></h3><p>What forwards-compatibility means will vary depending on the breaking change. For example:</p><ul><li>If a required field is being removed, make the field optional
on the <code>main</code> branch.</li><li>If a field is being renamed, the new field must be added to the <code>main</code> branch</li></ul><h3 id=add-deprecations-and-warnings-to-the-main-branch-of-magic-modules>Add deprecations and warnings to the <code>main</code> branch of <code>magic-modules</code>
<a class=anchor href=#add-deprecations-and-warnings-to-the-main-branch-of-magic-modules>#</a></h3><p>Deprecations and warnings must be actionable at the time that they are added
to the <code>main</code> branch, and they must be added prior to the <code>6.0.0</code>
major release. Every deprecation or warning should be surfaced to users of the
provider at runtime as well as in documentation.</p><h4 id=field-deprecation-due-to-removal-or-rename>Field deprecation (due to removal or rename)
<a class=anchor href=#field-deprecation-due-to-removal-or-rename>#</a></h4><div class=book-tabs><input type=radio class=toggle name="tabs-Field deprecations" id="tabs-Field deprecations-0" checked>
<label for="tabs-Field deprecations-0">MMv1</label><div class="book-tabs-content markdown-inner"><p>Set <code>deprecation_message</code> on the field. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;apiFieldName&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>String</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>description</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    MULTILINE_FIELD_DESCRIPTION</span>    
</span></span><span style=display:flex><span>  <span style=color:#f92672>deprecation_message</span>: <span style=color:#e6db74>&#39;`api_field_name` is deprecated and will be removed in a future major release. Use `other_field_name` instead.&#39;</span>
</span></span></code></pre></div><p>Replace the second sentence with an appropriate short description of the replacement path and/or the reason for
deprecation.</p><p>The deprecation message will automatically show up in the resource documentation.</p></div><input type=radio class=toggle name="tabs-Field deprecations" id="tabs-Field deprecations-1">
<label for="tabs-Field deprecations-1">Handwritten</label><div class="book-tabs-content markdown-inner"><ol><li><p>Set <code>Deprecated</code> on the field. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#e6db74>&#34;api_field_name&#34;</span>: {
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>Type</span>:       <span style=color:#a6e22e>schema</span>.<span style=color:#a6e22e>String</span>,
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>Deprecated</span>: <span style=color:#e6db74>&#34;`api_field_name` is deprecated and will be removed in a future major release. Use `other_field_name` instead.&#34;</span>,
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Replace the second sentence with an appropriate short description of the replacement path and/or the reason for
deprecation.</p></li><li><p>Update the <a href=https://googlecloudplatform.github.io/magic-modules/develop/resource/#add-documentation>documentation for the field</a> to include the deprecation notice. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=color:#66d9ef>*</span> <span style=color:#e6db74>`api_field_name`</span> - (Optional, [<span style=color:#f92672>Beta</span>](<span style=color:#a6e22e>https://terraform.io/docs/providers/google/guides/provider_versions.html</span>), Deprecated) FIELD_DESCRIPTION. <span style=color:#e6db74>`api_field_name`</span> is deprecated and will be removed in a future major release. Use <span style=color:#e6db74>`other_field_name`</span> instead.
</span></span></code></pre></div></li></ol></div></div><h4 id=resource-deprecation-due-to-removal-or-rename>Resource deprecation (due to removal or rename)
<a class=anchor href=#resource-deprecation-due-to-removal-or-rename>#</a></h4><div class=book-tabs><input type=radio class=toggle name="tabs-Resource deprecations" id="tabs-Resource deprecations-0" checked>
<label for="tabs-Resource deprecations-0">MMv1</label><div class="book-tabs-content markdown-inner"><p>Set <code>deprecation_message</code> on the resource. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>deprecation_message</span>: &gt;-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  `google_RESOURCE_NAME` is deprecated and will be removed in a future major release.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  Use `google_OTHER_RESOURCE_NAME` instead.</span>  
</span></span></code></pre></div><p>Replace RESOURCE_NAME with the name of the resource (excluding the <code>google_</code> prefix). Replace the
second sentence with an appropriate short description of the replacement path and/or the reason for
deprecation.</p><p>The deprecation message will automatically show up in the resource documentation.</p></div><input type=radio class=toggle name="tabs-Resource deprecations" id="tabs-Resource deprecations-1">
<label for="tabs-Resource deprecations-1">Handwritten</label><div class="book-tabs-content markdown-inner"><ol><li><p>Set <code>DeprecationMessage</code> on the field. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>schema</span>.<span style=color:#a6e22e>Resource</span>{
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>DeprecationMessage</span>: <span style=color:#e6db74>&#34;`google_RESOURCE_NAME` is deprecated and will be removed in a future &#34;</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>                       <span style=color:#e6db74>&#34;major release. Use `google_OTHER_RESOURCE_NAME` instead.&#34;</span>,
</span></span><span style=display:flex><span>   <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Replace RESOURCE_NAME with the name of the resource (excluding the <code>google_</code> prefix). Replace the
second sentence with an appropriate short description of the replacement path and/or the reason for
deprecation.</p></li><li><p>Add a warning to the resource documentation stating that the resource is deprecated. For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>~&gt; <span style=font-weight:700>**Warning:**</span> <span style=color:#e6db74>`google_RESOURCE_NAME`</span> is deprecated and will be removed in a future
</span></span><span style=display:flex><span>major release. Use <span style=color:#e6db74>`google_OTHER_RESOURCE_NAME`</span> instead.
</span></span></code></pre></div></li></ol></div></div><h4 id=other-breaking-changes>Other breaking changes
<a class=anchor href=#other-breaking-changes>#</a></h4><p>Other breaking changes should be called out in the docs for the impacted field
or resource. It is also great to log warnings at runtime if possible.</p><h3 id=make-the-change-on-feature-branch-major-release-600>Make the change on <code>FEATURE-BRANCH-major-release-6.0.0</code>
<a class=anchor href=#make-the-change-on-feature-branch-major-release-600>#</a></h3><p>When working on your breaking change, make sure that your base branch
is <code>FEATURE-BRANCH-major-release-6.0.0</code>. This
means that you will follow the standard
<a href=https://googlecloudplatform.github.io/magic-modules/contribution-process/>contribution process</a>
with the following changes:</p><ol><li>Before you start, check out and sync your local <code>magic-modules</code> and provider
repositories with the upstream major release branches.<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ~/magic-modules
</span></span><span style=display:flex><span>git checkout FEATURE-BRANCH-major-release-6.0.0
</span></span><span style=display:flex><span>git pull --ff-only origin FEATURE-BRANCH-major-release-6.0.0
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>git checkout FEATURE-BRANCH-major-release-6.0.0
</span></span><span style=display:flex><span>git pull --ff-only origin FEATURE-BRANCH-major-release-6.0.0
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>git checkout FEATURE-BRANCH-major-release-6.0.0
</span></span><span style=display:flex><span>git pull --ff-only origin FEATURE-BRANCH-major-release-6.0.0
</span></span></code></pre></div></li><li>Make sure that any deprecation notices and warnings that you added in previous sections
are present on the major release branch. Changes to the <code>main</code> branch will be
merged into the major release branch every Monday.</li><li>Make the breaking change.</li><li>Add the upgrade guide entries to
<a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/FEATURE-BRANCH-major-release-6.0.0/mmv1/third_party/terraform/website/docs/guides/version_6_upgrade.html.markdown>version_6_upgrade.html.markdown</a>. Entries should focus on the changes that users need to make when upgrading
to <code>6.0.0</code>, rather than how to write configurations
after upgrading. See <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/version_5_upgrade>Terraform provider for Google Cloud 5.0.0 Upgrade Guide</a>
and other upgrade guides for examples.</li><li>Remove any deprecation notices and warnings (including in documentation) not already removed by the breaking change.</li><li>When you create your pull request,
<a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/changing-the-base-branch-of-a-pull-request>change the base branch</a>
to <code>FEATURE-BRANCH-major-release-6.0.0</code></li><li>To resolve merge conflicts with <code>git rebase</code> or <code>git merge</code>, use <code>FEATURE-BRANCH-major-release-6.0.0</code> instead of <code>main</code>.</li></ol><h2 id=whats-next>What&rsquo;s next?
<a class=anchor href=#whats-next>#</a></h2><ul><li><a href=https://googlecloudplatform.github.io/magic-modules/develop/test/run-tests/>Run tests</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/d1c06aec3336adcaca9cc0ffa12b090a9517d8fd title='Last modified by nityaravi | November 14, 2024' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 14, 2024</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/develop%2fbreaking-changes%2fmake-a-breaking-change.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/develop/breaking-changes/make-a-breaking-change.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#in-minor-releases>In minor releases</a></li><li><a href=#in-the-600-major-release>In the 6.0.0 major release</a><ul><li><a href=#make-the-main-branch-forwards-compatible-with-the-major-release>Make the <code>main</code> branch forwards-compatible with the major release</a></li><li><a href=#add-deprecations-and-warnings-to-the-main-branch-of-magic-modules>Add deprecations and warnings to the <code>main</code> branch of <code>magic-modules</code></a></li><li><a href=#make-the-change-on-feature-branch-major-release-600>Make the change on <code>FEATURE-BRANCH-major-release-6.0.0</code></a></li></ul></li><li><a href=#whats-next>What&rsquo;s next?</a></li></ul></nav></div></aside></main></body></html>