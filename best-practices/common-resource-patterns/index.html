<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Common resource patterns#
Singletons#
Singletons are resources – often config or settings objects – that can only exist once. In some cases, it may be possible to create and delete the resource (but only one can exist at a time); in other cases the resource always exists and can only be read and updated.
Implementing resources like this may require some or all of the following:

If there isn&rsquo;t a create endpoint, set the create_url to point to the update endpoint.
If there is a create endpoint, add pre-create custom code that implements &ldquo;acquire-on-create&rdquo; logic. The custom code should check whether the resource already exists with a read request, and if it does, run the update logic and return early. For example, see mmv1/templates/terraform/pre_create/firebasehosting_site.go.tmpl.

Note: The main disadvantage of &ldquo;acquire-on-create&rdquo; logic is that users will not be presented with a diff between the resource&rsquo;s old and new states – because from the terraform perspective, the resource is only being created. Please upvote https://github.com/hashicorp/terraform/issues/19017 to request better support for this workflow.


If there is no delete endpoint, set exclude_delete: true at the top level of the resource.

Tests for singletons can run into issues because they are modifying a shared state. To avoid the problems this can cause, ensure that the tests create dedicated parent resources instead of modifying the default test environment. If there need to be multiple test cases, make sure they either have individual parent resources, or that they run serially, like TestAccAccessContextManager."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/best-practices/common-resource-patterns/"><meta property="og:site_name" content="Magic Modules"><meta property="og:title" content="Common resource patterns"><meta property="og:description" content="Common resource patterns# Singletons# Singletons are resources – often config or settings objects – that can only exist once. In some cases, it may be possible to create and delete the resource (but only one can exist at a time); in other cases the resource always exists and can only be read and updated.
Implementing resources like this may require some or all of the following:
If there isn’t a create endpoint, set the create_url to point to the update endpoint. If there is a create endpoint, add pre-create custom code that implements “acquire-on-create” logic. The custom code should check whether the resource already exists with a read request, and if it does, run the update logic and return early. For example, see mmv1/templates/terraform/pre_create/firebasehosting_site.go.tmpl. Note: The main disadvantage of “acquire-on-create” logic is that users will not be presented with a diff between the resource’s old and new states – because from the terraform perspective, the resource is only being created. Please upvote https://github.com/hashicorp/terraform/issues/19017 to request better support for this workflow. If there is no delete endpoint, set exclude_delete: true at the top level of the resource. Tests for singletons can run into issues because they are modifying a shared state. To avoid the problems this can cause, ensure that the tests create dedicated parent resources instead of modifying the default test environment. If there need to be multiple test cases, make sure they either have individual parent resources, or that they run serially, like TestAccAccessContextManager."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="best-practices"><meta property="article:modified_time" content="2025-06-02T08:17:26-07:00"><title>Common resource patterns | Magic Modules</title><link rel=icon href=/magic-modules/favicon.png><link rel=manifest href=/magic-modules/manifest.json><link rel=canonical href=https://googlecloudplatform.github.io/magic-modules/best-practices/common-resource-patterns/><link rel=stylesheet href=/magic-modules/book.min.34f6ea145e56d87823abe9f451d0a8fbe3dbcc6f9e02412199a014611b7adf70.css integrity="sha256-NPbqFF5W2Hgjq+n0UdCo++PbzG+eAkEhmaAUYRt633A=" crossorigin=anonymous><script defer src=/magic-modules/fuse.min.js></script><script defer src=/magic-modules/en.search.min.ed997fde5ff9dc8028f5dec3d3a2ea873935e206a2f9278120a638b6901740cc.js integrity="sha256-7Zl/3l/53IAo9d7D06Lqhzk14gai+SeBIKY4tpAXQMw=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-best-practices"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/magic-modules/ title=Overview>Overview</a></li></ul><ul><li><a href=/magic-modules/contribution-process/>Contribution process</a></li><li><input type=checkbox id=section-1218d39abefe7f824522d24e615b6429 class=toggle>
<label for=section-1218d39abefe7f824522d24e615b6429 class=flex><a role=button>Develop</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/develop/set-up-dev-environment/>Set up your development environment</a></li><li><a href=/magic-modules/develop/add-resource/>Add a resource</a></li><li><a href=/magic-modules/develop/add-fields/>Add a field to an existing resource</a></li><li><a href=/magic-modules/develop/add-iam-support/>Add IAM support</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/update-dependencies/>Update dependencies</a></li><li><a href=/magic-modules/develop/diffs/>Fix diffs</a></li><li><a href=/magic-modules/develop/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/develop/client-side-fields/>Client-side fields</a></li></ul></li><li><input type=checkbox id=section-46008ee5c4ef0e6f804abf3cfaea6dd0 class=toggle>
<label for=section-46008ee5c4ef0e6f804abf3cfaea6dd0 class=flex><a role=button>Test</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/test/test/>Add resource tests</a></li><li><a href=/magic-modules/test/run-tests/>Run tests</a></li></ul></li><li><input type=checkbox id=section-54e8c97150acf80b182bc188a6e6c492 class=toggle>
<label for=section-54e8c97150acf80b182bc188a6e6c492 class=flex><a role=button>Document</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/document/add-documentation/>Add documentation</a></li><li><a href=/magic-modules/document/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><input type=checkbox id=section-d11be9eb6f9aad36128162d909d31b29 class=toggle>
<label for=section-d11be9eb6f9aad36128162d909d31b29 class=flex><a role=button>Convert</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/convert/add-new-resource-tgc/>Add TGC conversion</a></li></ul></li><li><input type=checkbox id=section-ca39f9a7961e297a8c04b44ec69dbc58 class=toggle>
<label for=section-ca39f9a7961e297a8c04b44ec69dbc58 class=flex><a role=button>Breaking changes</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><input type=checkbox id=section-e42fc06bc1be2cad20d6487ff549c503 class=toggle>
<label for=section-e42fc06bc1be2cad20d6487ff549c503 class=flex><a role=button>Code review</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/code-review/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/code-review/release-notes/>Write release notes</a></li><li><a href=/magic-modules/code-review/review-pr/>Review a pull request</a></li></ul></li><li><input type=checkbox id=section-29607ad0ac6d788001e899a44038a031 class=toggle checked>
<label for=section-29607ad0ac6d788001e899a44038a031 class=flex><a role=button>Best practices</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/best-practices/immutable-fields/>Immutable fields</a></li><li><a href=/magic-modules/best-practices/deletion-behaviors/>Deletion behaviors</a></li><li><a href=/magic-modules/best-practices/labels-and-annotations/>Labels and annotations</a></li><li><a href=/magic-modules/best-practices/common-resource-patterns/ class=active>Common resource patterns</a></li><li><a href=/magic-modules/best-practices/validation/>Validation</a></li></ul></li><li><input type=checkbox id=section-3de530fff78b7e92c59925d632c7e725 class=toggle>
<label for=section-3de530fff78b7e92c59925d632c7e725 class=flex><a role=button>Reference</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/reference/resource/>MMv1 resource reference</a></li><li><a href=/magic-modules/reference/field/>MMv1 field reference</a></li><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=/magic-modules/reference/metadata/>MMv1 metadata reference</a></li><li><a href=/magic-modules/reference/ruby-go-changes/>Ruby to Go Migration</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/icons/menu.svg class=book-icon alt=Menu></label><h3>Common resource patterns</h3><label for=toc-control><img src=/magic-modules/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#singletons>Singletons</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=common-resource-patterns>Common resource patterns<a class=anchor href=#common-resource-patterns>#</a></h1><h2 id=singletons>Singletons<a class=anchor href=#singletons>#</a></h2><p>Singletons are resources – often config or settings objects – that can only exist once. In some cases, it may be possible to create and delete the resource (but only one can exist at a time); in other cases the resource <em>always</em> exists and can only be read and updated.</p><p>Implementing resources like this may require some or all of the following:</p><ol><li>If there <em>isn&rsquo;t</em> a create endpoint, set the <a href=https://googlecloudplatform.github.io/magic-modules/reference/resource/#create_url>create_url</a> to point to the update endpoint.</li><li>If there <em>is</em> a create endpoint, add <a href=https://googlecloudplatform.github.io/magic-modules/develop/custom-code/#pre_post_injection>pre-create custom code</a> that implements &ldquo;acquire-on-create&rdquo; logic. The custom code should check whether the resource already exists with a read request, and if it does, run the update logic and return early. For example, see <a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/dc4d9755cb9288177e0996c1c3b3fa9738ebdf89/mmv1/templates/terraform/pre_create/firebasehosting_site.go.tmpl>mmv1/templates/terraform/pre_create/firebasehosting_site.go.tmpl</a>.<ul><li>Note: The main disadvantage of &ldquo;acquire-on-create&rdquo; logic is that users will not be presented with a diff between the resource&rsquo;s old and new states – because from the terraform perspective, the resource is only being created. Please upvote <a href=https://github.com/hashicorp/terraform/issues/19017>https://github.com/hashicorp/terraform/issues/19017</a> to request better support for this workflow.</li></ul></li><li>If there is no delete endpoint, set <a href=https://googlecloudplatform.github.io/magic-modules/reference/resource/#create_url><code>exclude_delete: true</code></a> at the top level of the resource.</li></ol><p>Tests for singletons can run into issues because they are modifying a shared state. To avoid the problems this can cause, ensure that the tests <a href=https://googlecloudplatform.github.io/magic-modules/test/test/#create-test-projects>create dedicated parent resources</a> instead of modifying the default test environment. If there need to be multiple test cases, make sure they either have individual parent resources, or that they run serially, like <a href=https://github.com/hashicorp/terraform-provider-google-beta/blob/88fa0756f2ce116765edd4c1551680d9029621f6/google-beta/services/accesscontextmanager/resource_access_context_manager_access_policy_test.go#L31-L33>TestAccAccessContextManager</a>.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/414c7fa3f762a0160e9f74ee8477bf65a6b5bd34 title='Last modified by Stephen Lewis (Burrows) | June 2, 2025' target=_blank rel=noopener><img src=/magic-modules/icons/calendar.svg class=book-icon alt>
<span>June 2, 2025</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/best-practices%2fcommon-resource-patterns.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/icons/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/best-practices/common-resource-patterns.md target=_blank rel="noopener edit"><img src=/magic-modules/icons/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><div class="flex flex-wrap justify-between"><span><a href=/magic-modules/best-practices/labels-and-annotations/ class="flex align-center"><img src=/magic-modules/icons/backward.svg class=book-icon alt=Previous title="Labels and annotations">
<span>Labels and annotations</span>
</a></span><span><a href=/magic-modules/best-practices/validation/ class="flex align-center"><span>Validation</span>
<img src=/magic-modules/icons/forward.svg class=book-icon alt=Next title=Validation></a></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#singletons>Singletons</a></li></ul></nav></div></aside></main></body></html>