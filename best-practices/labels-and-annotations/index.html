<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Add labels and annotations support#

Note: This page covers best practices guidance for the Terraform provider for Google Cloud, which is used to ensure a consistent UX for Terraform users across providers or GCP users across the Google provider. Generally, this guidance should be followed and exceptions should be clearly demarcated / discussed.The new labels model and the new annotations model are introduced in Terraform provider for Google Cloud 5.0.0."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/best-practices/labels-and-annotations/"><meta property="og:site_name" content="Magic Modules"><meta property="og:title" content="Labels and annotations"><meta property="og:description" content="Add labels and annotations support# Note: This page covers best practices guidance for the Terraform provider for Google Cloud, which is used to ensure a consistent UX for Terraform users across providers or GCP users across the Google provider. Generally, this guidance should be followed and exceptions should be clearly demarcated / discussed.
The new labels model and the new annotations model are introduced in Terraform provider for Google Cloud 5.0.0."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="best-practices"><meta property="article:modified_time" content="2025-09-29T18:41:20+02:00"><title>Labels and annotations | Magic Modules</title><link rel=icon href=/magic-modules/favicon.png><link rel=manifest href=/magic-modules/manifest.json><link rel=canonical href=https://googlecloudplatform.github.io/magic-modules/best-practices/labels-and-annotations/><link rel=stylesheet href=/magic-modules/book.min.34f6ea145e56d87823abe9f451d0a8fbe3dbcc6f9e02412199a014611b7adf70.css integrity="sha256-NPbqFF5W2Hgjq+n0UdCo++PbzG+eAkEhmaAUYRt633A=" crossorigin=anonymous><script defer src=/magic-modules/fuse.min.js></script><script defer src=/magic-modules/en.search.min.a3e84ce93c57b8f1f7aba650892e6bd3561cb04dd07ba22510f748c8b632d38f.js integrity="sha256-o+hM6TxXuPH3q6ZQiS5r01YcsE3Qe6IlEPdIyLYy048=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-best-practices"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/magic-modules/ title=Overview>Overview</a></li></ul><ul><li><a href=/magic-modules/contribution-process/>Contribution process</a></li><li><input type=checkbox id=section-1218d39abefe7f824522d24e615b6429 class=toggle>
<label for=section-1218d39abefe7f824522d24e615b6429 class=flex><a role=button>Develop</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/develop/set-up-dev-environment/>Set up your development environment</a></li><li><a href=/magic-modules/develop/add-resource/>Add a resource</a></li><li><a href=/magic-modules/develop/add-fields/>Add a field to an existing resource</a></li><li><a href=/magic-modules/develop/add-iam-support/>Add IAM support</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/update-dependencies/>Update dependencies</a></li><li><a href=/magic-modules/develop/diffs/>Fix diffs</a></li><li><a href=/magic-modules/develop/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/develop/client-side-fields/>Client-side fields</a></li></ul></li><li><input type=checkbox id=section-46008ee5c4ef0e6f804abf3cfaea6dd0 class=toggle>
<label for=section-46008ee5c4ef0e6f804abf3cfaea6dd0 class=flex><a role=button>Test</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/test/test/>Add resource tests</a></li><li><a href=/magic-modules/test/run-tests/>Run tests</a></li></ul></li><li><input type=checkbox id=section-54e8c97150acf80b182bc188a6e6c492 class=toggle>
<label for=section-54e8c97150acf80b182bc188a6e6c492 class=flex><a role=button>Document</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/document/add-documentation/>Add documentation</a></li><li><a href=/magic-modules/document/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><input type=checkbox id=section-d11be9eb6f9aad36128162d909d31b29 class=toggle>
<label for=section-d11be9eb6f9aad36128162d909d31b29 class=flex><a role=button>Convert</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/convert/add-new-resource-tgc/>Add TGC conversion</a></li></ul></li><li><input type=checkbox id=section-ca39f9a7961e297a8c04b44ec69dbc58 class=toggle>
<label for=section-ca39f9a7961e297a8c04b44ec69dbc58 class=flex><a role=button>Breaking changes</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><input type=checkbox id=section-e42fc06bc1be2cad20d6487ff549c503 class=toggle>
<label for=section-e42fc06bc1be2cad20d6487ff549c503 class=flex><a role=button>Code review</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/code-review/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/code-review/release-notes/>Write release notes</a></li><li><a href=/magic-modules/code-review/review-pr/>Review a pull request</a></li></ul></li><li><input type=checkbox id=section-29607ad0ac6d788001e899a44038a031 class=toggle checked>
<label for=section-29607ad0ac6d788001e899a44038a031 class=flex><a role=button>Best practices</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/best-practices/immutable-fields/>Immutable fields</a></li><li><a href=/magic-modules/best-practices/deletion-behaviors/>Deletion behaviors</a></li><li><a href=/magic-modules/best-practices/labels-and-annotations/ class=active>Labels and annotations</a></li><li><a href=/magic-modules/best-practices/common-resource-patterns/>Common resource patterns</a></li><li><a href=/magic-modules/best-practices/validation/>Validation</a></li></ul></li><li><input type=checkbox id=section-3de530fff78b7e92c59925d632c7e725 class=toggle>
<label for=section-3de530fff78b7e92c59925d632c7e725 class=flex><a role=button>Reference</a>
<img src=/magic-modules/icons/chevron-right.svg class=book-icon></label><ul><li><a href=/magic-modules/reference/resource/>MMv1 resource reference</a></li><li><a href=/magic-modules/reference/field/>MMv1 field reference</a></li><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=/magic-modules/reference/metadata/>MMv1 metadata reference</a></li><li><a href=/magic-modules/reference/ruby-go-changes/>Ruby to Go Migration</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/icons/menu.svg class=book-icon alt=Menu></label><h3>Labels and annotations</h3><label for=toc-control><img src=/magic-modules/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#labels-support>Labels support</a><ul><li><a href=#mmv1-resources>MMv1 resources</a></li><li><a href=#handwritten-resources>Handwritten resources</a></li></ul></li><li><a href=#annotations-support>Annotations support</a><ul><li><a href=#mmv1-resources-1>MMv1 resources</a></li><li><a href=#handwritten-resources-1>Handwritten resources</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=add-labels-and-annotations-support>Add labels and annotations support<a class=anchor href=#add-labels-and-annotations-support>#</a></h1><blockquote class='book-hint note'><p><strong>Note:</strong> This page covers best practices guidance for the Terraform provider for Google Cloud, which is used to ensure a consistent UX for Terraform users across providers or GCP users across the Google provider. Generally, this guidance should be followed and exceptions should be clearly demarcated / discussed.</p></blockquote><p>The new labels model and the new annotations model are introduced in <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/version_5_upgrade#provider>Terraform provider for Google Cloud 5.0.0</a>.</p><p>There are now three label-related fields with the new labels model:</p><ul><li>The <code>labels</code> field is now non-authoritative and only manages the label keys defined in your configuration for the resource.</li><li>The <code>terraform_labels</code> cannot be specified directly by the user. It merges the labels defined in the resource&rsquo;s configuration and the default labels configured in the provider block. If the same label key exists on both the resource level and provider level, the value on the resource will override the provider-level default.</li><li>The output-only <code>effective_labels</code> will list all the labels present on the resource in GCP, including the labels configured through Terraform, the system, and other clients.</li></ul><p>There are now two annotation-related fields with the new annotations model:</p><ul><li>The <code>annotations</code> field is now non-authoritative and only manages the annotation keys defined in your configuration for the resource.</li><li>The output-only <code>effective_annotations</code> will list all the annotations present on the resource in GCP, including the annotations configured through Terraform, the system, and other clients.</li></ul><p>This document describes how to add <code>labels</code> and <code>annotations</code> field to resources to support the new models.</p><h2 id=labels-support>Labels support<a class=anchor href=#labels-support>#</a></h2><p>When adding a new <code>labels</code> field, please make the changes below to support the new labels model. Otherwise, it has to wait for the next major release to make the changes.</p><h3 id=mmv1-resources>MMv1 resources<a class=anchor href=#mmv1-resources>#</a></h3><ol><li><p>Use the type <code>KeyValueLabels</code> for the standard resource <code>labels</code> field. The standard resource <code>labels</code> field could be the top level <code>labels</code> field or the nested <code>labels</code> field inside the top level <code>metadata</code> field. Don&rsquo;t add <code>default_from_api: true</code> to this field or don&rsquo;t use this type for other <code>labels</code> fields in the resource. <code>KeyValueLabels</code> will add all of changes required for the new model automatically.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span> - <span style=color:#ff6ac1>name</span>: <span style=color:#5af78e>&#39;labels&#39;</span>
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>type</span>: KeyValueLabels
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>description</span>: |<span style=color:#5af78e>
</span></span></span><span style=display:flex><span><span style=color:#5af78e>   The labels associated with this dataset. You can use these to
</span></span></span><span style=display:flex><span><span style=color:#5af78e>   organize and group your datasets.</span></span></span></code></pre></div></li><li><p>In the handwritten acceptance tests, add <code>labels</code> and <code>terraform_labels</code> to <code>ImportStateVerifyIgnore</code> if <code>labels</code> field is in the configuration.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>ImportStateVerifyIgnore: []<span style=color:#9aedfe>string</span>{<span style=color:#5af78e>&#34;labels&#34;</span>, <span style=color:#5af78e>&#34;terraform_labels&#34;</span>}, </span></span></code></pre></div></li><li><p>In the corresponding data source, after the resource read method, call the function <code>tpgresource.SetDataSourceLabels(d)</code> to make <code>labels</code> and <code>terraform_labels</code> have all of the labels on the resource.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>err = <span style=color:#57c7ff>resourceArtifactRegistryRepositoryRead</span>(d, meta)
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> err
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> tpgresource.<span style=color:#57c7ff>SetDataSourceLabels</span>(d); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> err
</span></span><span style=display:flex><span>}</span></span></code></pre></div></li></ol><h3 id=handwritten-resources>Handwritten resources<a class=anchor href=#handwritten-resources>#</a></h3><ol><li>Add <code>tpgresource.SetLabelsDiff</code> to <code>CustomizeDiff</code> of the resource.<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>CustomizeDiff: customdiff.<span style=color:#57c7ff>All</span>(
</span></span><span style=display:flex><span>   tpgresource.SetLabelsDiff,
</span></span><span style=display:flex><span>),</span></span></code></pre></div></li><li>Add <code>labels</code> field and add more attributes (such as <code>ForceNew: true,</code>, <code>Set: schema.HashString,</code>) to this field if necessary.<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#5af78e>&#34;labels&#34;</span>: {
</span></span><span style=display:flex><span>   Type:     schema.TypeMap,
</span></span><span style=display:flex><span>   Optional: <span style=color:#ff6ac1>true</span>,
</span></span><span style=display:flex><span>   Elem:     <span style=color:#ff6ac1>&amp;</span>schema.Schema{Type: schema.TypeString},
</span></span><span style=display:flex><span>   Description: <span style=color:#5af78e>`A set of key/value label pairs to assign to the project.
</span></span></span><span style=display:flex><span><span style=color:#5af78e>
</span></span></span><span style=display:flex><span><span style=color:#5af78e>   **Note**: This field is non-authoritative, and will only manage the labels present in your configuration.
</span></span></span><span style=display:flex><span><span style=color:#5af78e>   Please refer to the field &#39;effective_labels&#39; for all of the labels present on the resource.`</span>,
</span></span><span style=display:flex><span>},</span></span></code></pre></div></li><li>Add output only field <code>terraform_labels</code> and add more attributes (such as <code>Set: schema.HashString,</code>) to this field if necessary. Don&rsquo;t add <code>ForceNew:true,</code> to this field.<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#5af78e>&#34;terraform_labels&#34;</span>: {
</span></span><span style=display:flex><span>   Type:        schema.TypeMap,
</span></span><span style=display:flex><span>   Computed:    <span style=color:#ff6ac1>true</span>,
</span></span><span style=display:flex><span>   Description: <span style=color:#5af78e>`The combination of labels configured directly on the resource and default labels configured on the provider.`</span>,
</span></span><span style=display:flex><span>   Elem:        <span style=color:#ff6ac1>&amp;</span>schema.Schema{Type: schema.TypeString},
</span></span><span style=display:flex><span>},</span></span></code></pre></div></li><li>Add output only field <code>effective_labels</code> and add more attributes (such as <code>ForceNew: true,</code>, <code>Set: schema.HashString,</code>) to this field if necessary.<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#5af78e>&#34;effective_labels&#34;</span>: {
</span></span><span style=display:flex><span>   Type:        schema.TypeMap,
</span></span><span style=display:flex><span>   Computed:    <span style=color:#ff6ac1>true</span>,
</span></span><span style=display:flex><span>   Description: <span style=color:#5af78e>`All of labels (key/value pairs) present on the resource in GCP, including the labels configured through Terraform, other clients and services.`</span>,
</span></span><span style=display:flex><span>   Elem:        <span style=color:#ff6ac1>&amp;</span>schema.Schema{Type: schema.TypeString},
</span></span><span style=display:flex><span>},</span></span></code></pre></div></li><li>In the create method, use the value of <code>effective_labels</code> in API request.</li><li>In the update method, use the value of <code>effective_labels</code> in API request.</li><li>In the read mehtod, set <code>labels</code>, <code>terraform_labels</code> and <code>effective_labels</code> to state.<div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> tpgresource.<span style=color:#57c7ff>SetLabels</span>(res.Labels, d, <span style=color:#5af78e>&#34;labels&#34;</span>); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> fmt.<span style=color:#57c7ff>Errorf</span>(<span style=color:#5af78e>&#34;Error setting labels: %s&#34;</span>, err)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> tpgresource.<span style=color:#57c7ff>SetLabels</span>(res.Labels, d, <span style=color:#5af78e>&#34;terraform_labels&#34;</span>); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> fmt.<span style=color:#57c7ff>Errorf</span>(<span style=color:#5af78e>&#34;Error setting terraform_labels: %s&#34;</span>, err)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> d.<span style=color:#57c7ff>Set</span>(<span style=color:#5af78e>&#34;effective_labels&#34;</span>, res.Labels); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> fmt.<span style=color:#57c7ff>Errorf</span>(<span style=color:#5af78e>&#34;Error setting effective_labels: %s&#34;</span>, err)
</span></span><span style=display:flex><span>}</span></span></code></pre></div></li><li>In the handwritten acceptance tests, add <code>labels</code> and <code>terraform_labels</code> to <code>ImportStateVerifyIgnore</code>.</li><li>In the corresponding data source, after the resource read method, call the function <code>tpgresource.SetDataSourceLabels(d)</code> to make <code>labels</code> and <code>terraform_labels</code> have all of the labels on the resource.</li><li>Add the documentation for these label-related fields.</li></ol><h2 id=annotations-support>Annotations support<a class=anchor href=#annotations-support>#</a></h2><p>When adding a new <code>annotations</code> field, please make the changes below below to support the new annotations model. Otherwise, it has to wait for the next major release to make the breaking changes.</p><h3 id=mmv1-resources-1>MMv1 resources<a class=anchor href=#mmv1-resources-1>#</a></h3><ol><li><p>Use the type <code>KeyValueAnnotations</code> for the standard resource <code>annotations</code> field. The standard resource <code>annotations</code> field could be the top level <code>annotations</code> field or the nested <code>annotations</code> field inside the top level <code>metadata</code> field. Don&rsquo;t add <code>default_from_api: true</code> to this field or don&rsquo;t use this type for other <code>annotations</code> fields in the resource. <code>KeyValueAnnotations</code> will add all of changes required for the new model automatically.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#ff6ac1>name</span>: <span style=color:#5af78e>&#39;annotations&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff6ac1>type</span>: KeyValueAnnotations
</span></span><span style=display:flex><span>  <span style=color:#ff6ac1>description</span>: |<span style=color:#5af78e>
</span></span></span><span style=display:flex><span><span style=color:#5af78e>    Client-specified annotations. This is distinct from labels.</span></span></span></code></pre></div></li><li><p>In the handwritten acceptance tests, add <code>annotations</code> to <code>ImportStateVerifyIgnore</code> if <code>annotations</code> field is in the configuration.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>ImportStateVerifyIgnore: []<span style=color:#9aedfe>string</span>{<span style=color:#5af78e>&#34;annotations&#34;</span>},</span></span></code></pre></div></li><li><p>In the corresponding data source, after the resource read method, call the function <code>tpgresource.SetDataSourceAnnotations(d)</code> to make <code>annotations</code> have all of the annotations on the resource.</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-go data-lang=go><span style=display:flex><span>err = <span style=color:#57c7ff>resourceSecretManagerSecretRead</span>(d, meta)
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> err
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> tpgresource.<span style=color:#57c7ff>SetDataSourceLabels</span>(d); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> err
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>if</span> err <span style=color:#ff6ac1>:=</span> tpgresource.<span style=color:#57c7ff>SetDataSourceAnnotations</span>(d); err <span style=color:#ff6ac1>!=</span> <span style=color:#ff6ac1>nil</span> {
</span></span><span style=display:flex><span>   <span style=color:#ff6ac1>return</span> err
</span></span><span style=display:flex><span>}</span></span></code></pre></div></li></ol><h3 id=handwritten-resources-1>Handwritten resources<a class=anchor href=#handwritten-resources-1>#</a></h3><ol><li>Add <code>tpgresource.SetAnnotationsDiff</code> to <code>CustomizeDiff</code> of the resource.</li><li>Add <code>annotations</code> field and add more attributes (such as <code>ForceNew: true,</code>, <code>Set: schema.HashString,</code>) to this field if necessary.</li><li>Add output only field <code>effective_annotations</code> and add more attributes (such as <code>ForceNew: true,</code>, <code>Set: schema.HashString,</code>) to this field if necessary.</li><li>In the create method, use the value of <code>effective_annotations</code> in API request.</li><li>In the update method, use the value of <code>effective_annotations</code> in API request.</li><li>In the read mehtod, set <code>annotations</code>, and <code>effective_annotations</code> to state.</li><li>In the handwritten acceptance tests, add <code>annotations</code> to <code>ImportStateVerifyIgnore</code>.</li><li>In the corresponding data source, after the resource read method, call the function <code>tpgresource.SetDataSourceAnnotations(d)</code> to make <code>annotations</code> have all of the labels on the resource.</li><li>Add the documentation for these annotation-related fields.</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/4c5ef7e13d1abc77bb9898471359231a4d2f05e0 title='Last modified by Alex Shpak | September 29, 2025' target=_blank rel=noopener><img src=/magic-modules/icons/calendar.svg class=book-icon alt>
<span>September 29, 2025</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/best-practices%2flabels-and-annotations.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/icons/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/best-practices/labels-and-annotations.md target=_blank rel="noopener edit"><img src=/magic-modules/icons/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><div class="flex flex-wrap justify-between"><span><a href=/magic-modules/best-practices/deletion-behaviors/ class="flex align-center"><img src=/magic-modules/icons/backward.svg class=book-icon alt=Previous title="Deletion behaviors">
<span>Deletion behaviors</span>
</a></span><span><a href=/magic-modules/best-practices/common-resource-patterns/ class="flex align-center"><span>Common resource patterns</span>
<img src=/magic-modules/icons/forward.svg class=book-icon alt=Next title="Common resource patterns"></a></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#labels-support>Labels support</a><ul><li><a href=#mmv1-resources>MMv1 resources</a></li><li><a href=#handwritten-resources>Handwritten resources</a></li></ul></li><li><a href=#annotations-support>Annotations support</a><ul><li><a href=#mmv1-resources-1>MMv1 resources</a></li><li><a href=#handwritten-resources-1>Handwritten resources</a></li></ul></li></ul></nav></div></aside></main></body></html>