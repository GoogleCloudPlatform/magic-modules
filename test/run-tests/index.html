<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Run tests
  #


  Before you begin
  #

Generate the modified provider(s)


Set up application default credentials for Terraform
gcloud auth application-default login
export GOOGLE_USE_DEFAULT_CREDENTIALS=true


Set the following environment variables:
export GOOGLE_PROJECT=PROJECT_ID
export GOOGLE_REGION=us-central1
export GOOGLE_ZONE=us-central1-a
Replace PROJECT_ID with the ID of the Google Cloud project you are using for testing.


Optional: Some tests may require additional variables to be set, such as:
GOOGLE_ORG
GOOGLE_BILLING_ACCOUNT



  Run automated tests
  #






  GA Provider
  

Run unit tests and linters"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/test/run-tests/"><meta property="og:site_name" content="Magic Modules"><meta property="og:title" content="Run tests"><meta property="og:description" content="Run tests # Before you begin # Generate the modified provider(s)
Set up application default credentials for Terraform
gcloud auth application-default login export GOOGLE_USE_DEFAULT_CREDENTIALS=true Set the following environment variables:
export GOOGLE_PROJECT=PROJECT_ID export GOOGLE_REGION=us-central1 export GOOGLE_ZONE=us-central1-a Replace PROJECT_ID with the ID of the Google Cloud project you are using for testing.
Optional: Some tests may require additional variables to be set, such as:
GOOGLE_ORG GOOGLE_BILLING_ACCOUNT Run automated tests # GA Provider Run unit tests and linters"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="test"><meta property="article:modified_time" content="2025-02-28T12:45:28-08:00"><title>Run tests | Magic Modules</title>
<link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png><link rel=canonical href=https://googlecloudplatform.github.io/magic-modules/test/run-tests/><link rel=stylesheet href=/magic-modules/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/magic-modules/fuse.min.js></script><script defer src=/magic-modules/en.search.min.f2fa01ab22b3e56affa1eb359fa5cb313d4958ce8a6dd0c1af61563b805a3926.js integrity="sha256-8voBqyKz5Wr/oes1n6XLMT1JWM6KbdDBr2FWO4BaOSY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><a href=/magic-modules/contribution-process/>Contribution process</a></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/set-up-dev-environment/>Set up your development environment</a></li><li><a href=/magic-modules/develop/add-resource/>Add a resource</a></li><li><a href=/magic-modules/develop/add-fields/>Add a field to an existing resource</a></li><li><a href=/magic-modules/develop/add-iam-support/>Add IAM support</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/update-dependencies/>Update dependencies</a></li><li><a href=/magic-modules/develop/diffs/>Fix diffs</a></li><li><a href=/magic-modules/develop/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/develop/client-side-fields/>Client-side fields</a></li></ul></li><li><span>Test</span><ul><li><a href=/magic-modules/test/test/>Add resource tests</a></li><li><a href=/magic-modules/test/run-tests/ class=active>Run tests</a></li></ul></li><li><span>Document</span><ul><li><a href=/magic-modules/document/add-documentation/>Add documentation</a></li><li><a href=/magic-modules/document/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><span>Breaking changes</span><ul><li><a href=/magic-modules/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><span>Code review</span><ul><li><a href=/magic-modules/code-review/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/code-review/release-notes/>Write release notes</a></li><li><a href=/magic-modules/code-review/review-pr/>Review a pull request</a></li></ul></li><li><span>Best practices</span><ul><li><a href=/magic-modules/best-practices/immutable-fields/>Immutable fields</a></li><li><a href=/magic-modules/best-practices/deletion-behaviors/>Deletion behaviors</a></li><li><a href=/magic-modules/best-practices/labels-and-annotations/>Labels and annotations</a></li><li><a href=/magic-modules/best-practices/common-resource-patterns/>Common resource patterns</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/resource/>MMv1 resource reference</a></li><li><a href=/magic-modules/reference/field/>MMv1 field reference</a></li><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=/magic-modules/reference/metadata/>MMv1 metadata reference</a></li><li><a href=/magic-modules/reference/ruby-go-changes/>Ruby to Go Migration</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Run tests</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#run-automated-tests>Run automated tests</a></li><li><a href=#troubleshooting>Troubleshooting acceptance tests</a><ul><li><a href=#after-applying-this-test-step-the-plan-was-not-empty>After applying this test step, the plan was not empty.</a></li><li><a href=#blocks-of-type-field_name-are-not-expected-here>Blocks of type &ldquo;FIELD_NAME&rdquo; are not expected here</a></li><li><a href=#provider-produced-inconsistent-result-after-apply--root-object-was-present-but-now-absent>Provider produced inconsistent result after apply &mldr; Root object was present, but now absent.</a></li></ul></li><li><a href=#optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions</a></li><li><a href=#optional-test-manually>Optional: Test manually</a><ul><li><a href=#before-you-begin-1>Before you begin</a></li><li><a href=#run-manual-tests>Run manual tests</a></li><li><a href=#run-tests-with-vcr-locally>Run Tests with VCR Locally</a></li><li><a href=#cleanup>Cleanup</a></li></ul></li><li><a href=#whats-next>What&rsquo;s next?</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=run-tests>Run tests
<a class=anchor href=#run-tests>#</a></h1><h2 id=before-you-begin>Before you begin
<a class=anchor href=#before-you-begin>#</a></h2><p><a href=https://googlecloudplatform.github.io/magic-modules/develop/generate-providers/>Generate the modified provider(s)</a></p><ol><li><p>Set up application default credentials for Terraform</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud auth application-default login
</span></span><span style=display:flex><span>export GOOGLE_USE_DEFAULT_CREDENTIALS<span style=color:#f92672>=</span>true
</span></span></code></pre></div></li><li><p>Set the following environment variables:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export GOOGLE_PROJECT<span style=color:#f92672>=</span>PROJECT_ID
</span></span><span style=display:flex><span>export GOOGLE_REGION<span style=color:#f92672>=</span>us-central1
</span></span><span style=display:flex><span>export GOOGLE_ZONE<span style=color:#f92672>=</span>us-central1-a
</span></span></code></pre></div><p>Replace <code>PROJECT_ID</code> with the ID of the Google Cloud project you are using for testing.</p></li><li><p>Optional: Some tests may require additional variables to be set, such as:</p><pre tabindex=0><code>GOOGLE_ORG
GOOGLE_BILLING_ACCOUNT
</code></pre></li></ol><h2 id=run-automated-tests>Run automated tests
<a class=anchor href=#run-automated-tests>#</a></h2><div class=book-tabs><input type=radio class=toggle name=tabs-version id=tabs-version-0 checked>
<label for=tabs-version-0>GA Provider</label><div class="book-tabs-content markdown-inner"><ol><li><p>Run unit tests and linters</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make test
</span></span><span style=display:flex><span>make lint
</span></span></code></pre></div></li><li><p>Run acceptance tests for only modified resources. (Full test runs can take over 9 hours.) See <a href=https://pkg.go.dev/cmd/go#hdr-Testing_flags>Go&rsquo;s documentation</a> for more information about <code>-run</code> and other flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic$$&#39;</span>
</span></span></code></pre></div><p>To run all tests matching, e.g., <code>TestAccContainerNodePool*</code>, omit the trailing <code>$$</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool&#39;</span>
</span></span></code></pre></div><blockquote><p><strong>Note:</strong> Acceptance tests create actual infrastructure which can incur costs. Acceptance tests may not clean up after themselves if interrupted, so you may want to check for stray resources and / or billing charges.</p></blockquote></li><li><p>Optional: Save verbose test output (including API requests and responses) to a file for analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>DEBUG make testacc TEST<span style=color:#f92672>=</span>./google/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic$$&#39;</span> &gt; output.log
</span></span></code></pre></div></li><li><p>Optional: Debug tests with <a href=https://github.com/go-delve/delve>Delve</a>. See <a href=https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_test.md><code>dlv test</code> documentation</a> for information about available flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd google
</span></span><span style=display:flex><span>TF_ACC<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> dlv test -- --test.v --test.run TestAccComputeRegionBackendService_withCdnPolicy
</span></span></code></pre></div></li></ol></div><input type=radio class=toggle name=tabs-version id=tabs-version-1>
<label for=tabs-version-1>Beta Provider</label><div class="book-tabs-content markdown-inner"><ol><li><p>Run unit tests and linters</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make test
</span></span><span style=display:flex><span>make lint
</span></span></code></pre></div></li><li><p>Run acceptance tests for only modified resources. (Full test runs can take over 9 hours.) See <a href=https://pkg.go.dev/cmd/go#hdr-Testing_flags>Go&rsquo;s documentation</a> for more information about <code>-run</code> and other flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google-beta/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool&#39;</span>
</span></span></code></pre></div><p>To run all tests matching, e.g., <code>TestAccContainerNodePool*</code>, omit the trailing <code>$$</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google-beta/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool&#39;</span>
</span></span></code></pre></div><blockquote><p><strong>Note:</strong> Acceptance tests create actual infrastructure which can incur costs. Acceptance tests may not clean up after themselves if interrupted, so you may want to check for stray resources and / or billing charges.</p></blockquote></li><li><p>Optional: Save verbose test output to a file for analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>DEBUG make testacc TEST<span style=color:#f92672>=</span>./google-beta/services/container TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic$$&#39;</span> &gt; output.log
</span></span></code></pre></div></li><li><p>Optional: Debug tests with <a href=https://github.com/go-delve/delve>Delve</a>. See <a href=https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_test.md><code>dlv test</code> documentation</a> for information about available flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd google-beta
</span></span><span style=display:flex><span>TF_ACC<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> dlv test -- --test.v --test.run TestAccComputeRegionBackendService_withCdnPolicy
</span></span></code></pre></div></li></ol></div></div><h2 id=troubleshooting>Troubleshooting acceptance tests
<a class=anchor href=#troubleshooting>#</a></h2><h3 id=after-applying-this-test-step-the-plan-was-not-empty>After applying this test step, the plan was not empty.
<a class=anchor href=#after-applying-this-test-step-the-plan-was-not-empty>#</a></h3><p>This indicates that the returned values from the API (which will be displayed on the left) are different than what is in the configuration (displayed on the right). Fields which are listed as &ldquo;known after apply&rdquo; are not the cause of the diff and can be ignored in terms of resolving the issue.</p><p>See <a href=https://googlecloudplatform.github.io/magic-modules/develop/diffs/>Fix diffs</a> for more information on potential causes and fixes.</p><h3 id=blocks-of-type-field_name-are-not-expected-here>Blocks of type &ldquo;FIELD_NAME&rdquo; are not expected here
<a class=anchor href=#blocks-of-type-field_name-are-not-expected-here>#</a></h3><p>The field called <code>FIELD_NAME</code> does not exist; this is either because it has not been implemented or because the test is running for the <code>google</code> provider and the field is only implemented in the <code>google-beta</code> provider. See <a href=https://googlecloudplatform.github.io/magic-modules/test/test/>Add resource tests</a> for information on using version guards to exclude beta-only fields from GA tests, or <a href=https://googlecloudplatform.github.io/magic-modules/develop/promote-to-ga/>Promote from beta to GA</a> for information on how to promote fields that were accidentally made beta-only.</p><h3 id=provider-produced-inconsistent-result-after-apply--root-object-was-present-but-now-absent>Provider produced inconsistent result after apply &mldr; Root object was present, but now absent.
<a class=anchor href=#provider-produced-inconsistent-result-after-apply--root-object-was-present-but-now-absent>#</a></h3><p>This indicates that after an apply to create or update a resource, the resource was not present in Terraform state. This generally means one of a few things:</p><ul><li><a href=https://googlecloudplatform.github.io/magic-modules/develop/diffs/#eventually-consistent>API is eventually consistent or returns an Operation</a></li><li>The URL for reads was built incorrectly. The exact fix will depend on why this is happening. Run the test with the <code>TF_LOG=DEBUG</code> environment variable and check whether the read URL matches what you expect.</li><li>There is a call to unset the resource&rsquo;s id (<code>d.SetId("")</code>) somewhere it shouldn&rsquo;t be. The fix is to remove that extraneous call. This is rare.</li></ul><h2 id=optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions
<a class=anchor href=#optional-test-with-different-terraform-versions>#</a></h2><p>Tests will use whatever version of the <code>terraform</code> binary is found on your <code>PATH</code>. If you are testing a change that you know only impacts certain <code>terraform</code> versions, follow these steps:</p><ol><li><p>Install <a href=https://github.com/tfutils/tfenv><code>tfenv</code></a>.</p></li><li><p>Install the version of <code>terraform</code> you want to test.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tfenv install VERSION
</span></span></code></pre></div><p>Replace <code>VERSION</code> with the version you want to test.</p></li><li><p>Run automated tests following the <a href=https://googlecloudplatform.github.io/magic-modules/test/run-tests/#run-automated-tests>earlier section</a>.</p></li></ol><h2 id=optional-test-manually>Optional: Test manually
<a class=anchor href=#optional-test-manually>#</a></h2><p>For manual testing, you can build the provider from source and run <code>terraform apply</code> to verify the behavior.</p><h3 id=before-you-begin-1>Before you begin
<a class=anchor href=#before-you-begin-1>#</a></h3><p>Configure Terraform to use locally-built binaries for <code>google</code> and <code>google-beta</code> instead of downloading the latest versions.</p><div class=book-tabs><input type=radio class=toggle name=tabs-built-provider id=tabs-built-provider-0 checked>
<label for=tabs-built-provider-0>Developer overrides (Mac / Linux)</label><div class="book-tabs-content markdown-inner"><ol><li><p>Find the location where built provider binaries are created. To do this, run this command and make a note of the path value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go env GOBIN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## If the above returns nothing, then run the command below and add &#34;/bin&#34; to the end of the output path.</span>
</span></span><span style=display:flex><span>go env GOPATH
</span></span></code></pre></div></li><li><p>Create an empty configuration file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## create an empty file</span>
</span></span><span style=display:flex><span>touch ~/tf-dev-override.tfrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## open the file with a text editor of your choice, e.g:</span>
</span></span><span style=display:flex><span>vi ~/tf-dev-override.tfrc
</span></span></code></pre></div><p>Open the empty file with a text editor and paste in these contents:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>provider_installation</span> {<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # Developer overrides will stop Terraform from downloading the listed
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # providers their origin provider registries.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>dev_overrides</span> {
</span></span><span style=display:flex><span>      &#34;hashicorp/google&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH/bin&#34;</span>
</span></span><span style=display:flex><span>      &#34;hashicorp/google-beta&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH/bin&#34;</span>
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # For all other providers, install them directly from their origin provider
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # registries as normal. If you omit this, Terraform will _only_ use
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # the dev_overrides block, and so no other providers will be available.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>direct</span> {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>Edit the file to replace <code>GO_BIN_PATH</code> with the path you saved from the first step, making sure to keep <code>/bin</code> at the end of the path.</p><p><strong>Please note</strong>: the <em>full</em> path is required and environment variables cannot be used. For example, <code>"/Users/UserName/go/bin"</code> is a valid path for a user called <code>UserName</code>, but <code>"~/go/bin"</code> or <code>"$HOME/go/bin"</code> will not work.</p></li><li><p>Save the file.</p></li></ol></div><input type=radio class=toggle name=tabs-built-provider id=tabs-built-provider-1>
<label for=tabs-built-provider-1>Developer overrides (Windows)</label><div class="book-tabs-content markdown-inner"><ol><li><p>Find the location where built provider binaries are created. To do this, run this command and make a note of the path value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo %GOPATH%
</span></span></code></pre></div></li><li><p>Create an empty configuration file in the <code>%APPDATA%</code> directory (use <code>$env:APPDATA</code> in PowerShell to find its location on your system).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e>## create an empty file</span>
</span></span><span style=display:flex><span>type nul &gt; <span style=color:#e6db74>&#34;</span>$($env:APPDATA)<span style=color:#e6db74>\tf-dev-override.tfrc&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## open the file with a text editor of your choice, e.g:</span>
</span></span><span style=display:flex><span>notepad <span style=color:#e6db74>&#34;</span>$($env:APPDATA)<span style=color:#e6db74>\tf-dev-override.tfrc&#34;</span>
</span></span></code></pre></div><p>Open the empty file with a text editor and paste in these contents:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>provider_installation</span> {<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # Developer overrides will stop Terraform from downloading the listed
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # providers their origin provider registries.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>dev_overrides</span> {
</span></span><span style=display:flex><span>      &#34;hashicorp/google&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH\bin&#34;</span>
</span></span><span style=display:flex><span>      &#34;hashicorp/google-beta&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH\bin&#34;</span>
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # For all other providers, install them directly from their origin provider
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # registries as normal. If you omit this, Terraform will _only_ use
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # the dev_overrides block, and so no other providers will be available.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>direct</span> {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>Edit the file to replace <code>GO_BIN_PATH</code> with the output you saved from the first step, making sure to keep <code>\bin</code> at the end of the path.</p><p><strong>Please note</strong>: The <em>full</em> path is required and environment variables cannot be used. For example, <code>C:\Users\UserName\go\bin</code> is a valid path for a user called <code>UserName</code>.</p></li><li><p>Save the file.</p></li></ol></div></div><h3 id=run-manual-tests>Run manual tests
<a class=anchor href=#run-manual-tests>#</a></h3><ol><li><p><a href=https://googlecloudplatform.github.io/magic-modules/develop/generate-providers/>Generate the provider(s) you want to test</a></p></li><li><p>Build the provider(s) you want to test</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## google provider</span>
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## google-beta provider</span>
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make build
</span></span></code></pre></div></li><li><p>Create a new directory and a <code>main.tf</code> file with your resource and its dependencies.</p></li><li><p>In the new directory, run <code>terraform plan</code> as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_CLI_CONFIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/tf-dev-override.tfrc&#34;</span> terraform plan
</span></span></code></pre></div><p>Replace the TF_CLI_CONFIG_FILE value with the full path to your developer overrides file.</p></li><li><p>Optional: Verify that developer overrides are working by looking for output like the following near the start of the output:</p><pre tabindex=0><code>│ Warning: Provider development overrides are in effect
│ 
│ The following provider development overrides are set in the CLI configuration:
│  - hashicorp/google in /Users/UserName/go/bin
│  - hashicorp/google-beta in /Users/UserName/go/bin
│ 
│ The behavior may therefore not match any released version of the provider and applying
│ changes may cause the state to become incompatible with published releases.
</code></pre></li><li><p>Run <code>terraform apply</code> with developer overrides.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_CLI_CONFIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/tf-dev-override.tfrc&#34;</span> terraform apply
</span></span></code></pre></div></li><li><p>Optional: Save verbose <code>terraform apply</code> output (including API requests and responses) to a file for analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>DEBUG TF_LOG_PATH<span style=color:#f92672>=</span>output.log TF_CLI_CONFIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/tf-dev-override.tfrc&#34;</span> terraform apply
</span></span></code></pre></div></li></ol><h3 id=run-tests-with-vcr-locally>Run Tests with VCR Locally
<a class=anchor href=#run-tests-with-vcr-locally>#</a></h3><p>VCR tests record HTTP request/response interactions in cassettes and replay them in future runs without calling the real API.</p><p>Running tests in <code>REPLAYING</code> mode locally can sometimes be useful. In particular, it can allow you to test more quickly, cheaply, and without spinning up real infrastructure, once you&rsquo;ve got an initial recording.</p><p>It can also be helpful for debugging tests that seem to work locally, but fail in CI in replaying mode.</p><p>VCR is controlled via two variables:</p><ul><li><code>VCR_MODE</code>: <code>REPLAYING</code> or <code>RECORDING</code> mode</li><li><code>VCR_PATH</code>: Path where recorded cassettes are stored.</li></ul><p>Ensure both variables are configured to properly trigger VCR tests locally.</p><p>If you don&rsquo;t already have an existing cassette that&rsquo;s up to date, first do a run in <code>RECORDING</code> mode:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>VCR_PATH<span style=color:#f92672>=</span>$HOME/.vcr/ VCR_MODE<span style=color:#f92672>=</span>RECORDING  make testacc TEST<span style=color:#f92672>=</span>./google/services/alloydb TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic$$&#39;</span>
</span></span></code></pre></div><p>Now run the same test again in <code>REPLAYING</code> mode:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>VCR_PATH<span style=color:#f92672>=</span>$HOME/.vcr/ VCR_MODE<span style=color:#f92672>=</span>REPLAYING make testacc TEST<span style=color:#f92672>=</span>./google/services/alloydb TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic$$&#39;</span>
</span></span></code></pre></div><h3 id=cleanup>Cleanup
<a class=anchor href=#cleanup>#</a></h3><p>To stop using developer overrides, stop setting <code>TF_CLI_CONFIG_FILE</code> in the commands you are executing.</p><p>Terraform will resume its normal behaviour of pulling published provider versions from the public Registry. Any version constraints in your Terraform configuration will come back into effect. Also, you may need to run <code>terraform init</code> to download the required version of the provider into your project directory if you haven&rsquo;t already.</p><h2 id=whats-next>What&rsquo;s next?
<a class=anchor href=#whats-next>#</a></h2><p><a href=https://googlecloudplatform.github.io/magic-modules/code-review/create-pr/>Create a pull request</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/ebb8c3a337201d8245c47ccbb1669914a7c3e0a6 title='Last modified by Stephen Lewis (Burrows) | February 28, 2025' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 28, 2025</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/test%2frun-tests.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/test/run-tests.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#run-automated-tests>Run automated tests</a></li><li><a href=#troubleshooting>Troubleshooting acceptance tests</a><ul><li><a href=#after-applying-this-test-step-the-plan-was-not-empty>After applying this test step, the plan was not empty.</a></li><li><a href=#blocks-of-type-field_name-are-not-expected-here>Blocks of type &ldquo;FIELD_NAME&rdquo; are not expected here</a></li><li><a href=#provider-produced-inconsistent-result-after-apply--root-object-was-present-but-now-absent>Provider produced inconsistent result after apply &mldr; Root object was present, but now absent.</a></li></ul></li><li><a href=#optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions</a></li><li><a href=#optional-test-manually>Optional: Test manually</a><ul><li><a href=#before-you-begin-1>Before you begin</a></li><li><a href=#run-manual-tests>Run manual tests</a></li><li><a href=#run-tests-with-vcr-locally>Run Tests with VCR Locally</a></li><li><a href=#cleanup>Cleanup</a></li></ul></li><li><a href=#whats-next>What&rsquo;s next?</a></li></ul></nav></div></aside></main></body></html>